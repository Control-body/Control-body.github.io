<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Nginx总结 | Control.</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/img/favicon.png">
    <link rel="stylesheet" href="/css/style.css">
    <script charset="utf-8" src="/js/main.js"></script>
    <meta name="description" content="去发光,而不是被照亮">
    
    <link rel="preload" href="/assets/css/0.styles.f4923bad.css" as="style"><link rel="preload" href="/assets/js/app.19543062.js" as="script"><link rel="preload" href="/assets/js/2.0ee43227.js" as="script"><link rel="preload" href="/assets/js/105.8d220a0b.js" as="script"><link rel="prefetch" href="/assets/js/10.e58b7d3b.js"><link rel="prefetch" href="/assets/js/100.2a9b953a.js"><link rel="prefetch" href="/assets/js/101.859b2f1e.js"><link rel="prefetch" href="/assets/js/102.de57107f.js"><link rel="prefetch" href="/assets/js/103.810791da.js"><link rel="prefetch" href="/assets/js/104.2a858183.js"><link rel="prefetch" href="/assets/js/106.96fc31f2.js"><link rel="prefetch" href="/assets/js/107.30ac6bd5.js"><link rel="prefetch" href="/assets/js/108.f40e9ef7.js"><link rel="prefetch" href="/assets/js/109.7354eeca.js"><link rel="prefetch" href="/assets/js/11.22d06b73.js"><link rel="prefetch" href="/assets/js/110.d2316756.js"><link rel="prefetch" href="/assets/js/111.75dd52f1.js"><link rel="prefetch" href="/assets/js/112.9d8dda4d.js"><link rel="prefetch" href="/assets/js/113.e83d3089.js"><link rel="prefetch" href="/assets/js/114.5211e116.js"><link rel="prefetch" href="/assets/js/115.720242c4.js"><link rel="prefetch" href="/assets/js/116.ffc4f30c.js"><link rel="prefetch" href="/assets/js/117.42cd696e.js"><link rel="prefetch" href="/assets/js/118.40e1432e.js"><link rel="prefetch" href="/assets/js/119.3a8957dc.js"><link rel="prefetch" href="/assets/js/12.a654ee1a.js"><link rel="prefetch" href="/assets/js/120.2b0a9300.js"><link rel="prefetch" href="/assets/js/121.04096719.js"><link rel="prefetch" href="/assets/js/122.1a58fe68.js"><link rel="prefetch" href="/assets/js/123.159dcd59.js"><link rel="prefetch" href="/assets/js/124.bd4deaf4.js"><link rel="prefetch" href="/assets/js/125.6e049d24.js"><link rel="prefetch" href="/assets/js/126.bfc57933.js"><link rel="prefetch" href="/assets/js/127.9b253d7c.js"><link rel="prefetch" href="/assets/js/128.ffcac091.js"><link rel="prefetch" href="/assets/js/129.9e23da4e.js"><link rel="prefetch" href="/assets/js/13.1c933f28.js"><link rel="prefetch" href="/assets/js/130.6a87ad19.js"><link rel="prefetch" href="/assets/js/131.231bcc33.js"><link rel="prefetch" href="/assets/js/14.6afb9e3b.js"><link rel="prefetch" href="/assets/js/15.2e4d6ff0.js"><link rel="prefetch" href="/assets/js/16.61f286cd.js"><link rel="prefetch" href="/assets/js/17.ed9f0af6.js"><link rel="prefetch" href="/assets/js/18.e84e6471.js"><link rel="prefetch" href="/assets/js/19.76e080d8.js"><link rel="prefetch" href="/assets/js/20.2b2bf9bd.js"><link rel="prefetch" href="/assets/js/21.63da56e6.js"><link rel="prefetch" href="/assets/js/22.fb3ff4f4.js"><link rel="prefetch" href="/assets/js/23.fdca031f.js"><link rel="prefetch" href="/assets/js/24.92f82c60.js"><link rel="prefetch" href="/assets/js/25.a7a9704b.js"><link rel="prefetch" href="/assets/js/26.069c1e52.js"><link rel="prefetch" href="/assets/js/27.5f9a3c75.js"><link rel="prefetch" href="/assets/js/28.03fc0a93.js"><link rel="prefetch" href="/assets/js/29.cbc373fb.js"><link rel="prefetch" href="/assets/js/3.7be5a5a6.js"><link rel="prefetch" href="/assets/js/30.8681b9c2.js"><link rel="prefetch" href="/assets/js/31.36a09955.js"><link rel="prefetch" href="/assets/js/32.3b0c91db.js"><link rel="prefetch" href="/assets/js/33.d6de13ff.js"><link rel="prefetch" href="/assets/js/34.d9c51bc9.js"><link rel="prefetch" href="/assets/js/35.62ae3575.js"><link rel="prefetch" href="/assets/js/36.58249b42.js"><link rel="prefetch" href="/assets/js/37.c15ea66a.js"><link rel="prefetch" href="/assets/js/38.4ae7765d.js"><link rel="prefetch" href="/assets/js/39.57ec096f.js"><link rel="prefetch" href="/assets/js/4.e3eff0c1.js"><link rel="prefetch" href="/assets/js/40.f6d39637.js"><link rel="prefetch" href="/assets/js/41.08935a30.js"><link rel="prefetch" href="/assets/js/42.16f30978.js"><link rel="prefetch" href="/assets/js/43.9ba5877d.js"><link rel="prefetch" href="/assets/js/44.12534072.js"><link rel="prefetch" href="/assets/js/45.17e2d9c7.js"><link rel="prefetch" href="/assets/js/46.e281b6c7.js"><link rel="prefetch" href="/assets/js/47.7ad6135f.js"><link rel="prefetch" href="/assets/js/48.30bd52b0.js"><link rel="prefetch" href="/assets/js/49.6a40dfb5.js"><link rel="prefetch" href="/assets/js/5.12a90c90.js"><link rel="prefetch" href="/assets/js/50.85a351d0.js"><link rel="prefetch" href="/assets/js/51.78da0798.js"><link rel="prefetch" href="/assets/js/52.2310f240.js"><link rel="prefetch" href="/assets/js/53.d0049f2c.js"><link rel="prefetch" href="/assets/js/54.28aa5c87.js"><link rel="prefetch" href="/assets/js/55.381915f1.js"><link rel="prefetch" href="/assets/js/56.89d6cf82.js"><link rel="prefetch" href="/assets/js/57.a66c0467.js"><link rel="prefetch" href="/assets/js/58.e58969db.js"><link rel="prefetch" href="/assets/js/59.b83e284f.js"><link rel="prefetch" href="/assets/js/6.6e2b9d44.js"><link rel="prefetch" href="/assets/js/60.e860c237.js"><link rel="prefetch" href="/assets/js/61.681c3973.js"><link rel="prefetch" href="/assets/js/62.1659a827.js"><link rel="prefetch" href="/assets/js/63.1d1cf38e.js"><link rel="prefetch" href="/assets/js/64.59592269.js"><link rel="prefetch" href="/assets/js/65.ba2fd2ad.js"><link rel="prefetch" href="/assets/js/66.7aeca197.js"><link rel="prefetch" href="/assets/js/67.465b9930.js"><link rel="prefetch" href="/assets/js/68.4fcb7ca0.js"><link rel="prefetch" href="/assets/js/69.4f596a23.js"><link rel="prefetch" href="/assets/js/7.57edeeaa.js"><link rel="prefetch" href="/assets/js/70.3e6e1486.js"><link rel="prefetch" href="/assets/js/71.e61e28bf.js"><link rel="prefetch" href="/assets/js/72.b1db453c.js"><link rel="prefetch" href="/assets/js/73.a2f3e59e.js"><link rel="prefetch" href="/assets/js/74.bbed54ec.js"><link rel="prefetch" href="/assets/js/75.ac927282.js"><link rel="prefetch" href="/assets/js/76.b8c73cb1.js"><link rel="prefetch" href="/assets/js/77.ef60f934.js"><link rel="prefetch" href="/assets/js/78.5fea10e9.js"><link rel="prefetch" href="/assets/js/79.03d5c3e2.js"><link rel="prefetch" href="/assets/js/8.b6d1b803.js"><link rel="prefetch" href="/assets/js/80.13f6c1be.js"><link rel="prefetch" href="/assets/js/81.d69dc869.js"><link rel="prefetch" href="/assets/js/82.249e8ad4.js"><link rel="prefetch" href="/assets/js/83.95546593.js"><link rel="prefetch" href="/assets/js/84.16a183f4.js"><link rel="prefetch" href="/assets/js/85.bd7c1060.js"><link rel="prefetch" href="/assets/js/86.eaf7a944.js"><link rel="prefetch" href="/assets/js/87.2bd3e7b3.js"><link rel="prefetch" href="/assets/js/88.2578814c.js"><link rel="prefetch" href="/assets/js/89.b21857df.js"><link rel="prefetch" href="/assets/js/9.c4657130.js"><link rel="prefetch" href="/assets/js/90.9bc44c6e.js"><link rel="prefetch" href="/assets/js/91.387c0822.js"><link rel="prefetch" href="/assets/js/92.b05edf47.js"><link rel="prefetch" href="/assets/js/93.7522f244.js"><link rel="prefetch" href="/assets/js/94.87fb34a3.js"><link rel="prefetch" href="/assets/js/95.d77f7cc3.js"><link rel="prefetch" href="/assets/js/96.930684d9.js"><link rel="prefetch" href="/assets/js/97.1c7c9646.js"><link rel="prefetch" href="/assets/js/98.3d1417a1.js"><link rel="prefetch" href="/assets/js/99.ad52d8a0.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f4923bad.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Control.</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="语言" class="dropdown-title"><span class="title">语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="语言" class="mobile-dropdown-title"><span class="title">语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          java
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/baodian/zero/" class="nav-link">
  面向对象基础
</a></li><li class="dropdown-subitem"><a href="/baodian/high/" class="nav-link">
  java进阶-集合框架
</a></li><li class="dropdown-subitem"><a href="/baodian/high/" class="nav-link">
  java进阶-并发框架
</a></li><li class="dropdown-subitem"><a href="/baodian/high/" class="nav-link">
  java进阶-IO框架
</a></li><li class="dropdown-subitem"><a href="/baodian/high/" class="nav-link">
  java进阶-新版本特性
</a></li><li class="dropdown-subitem"><a href="/baodian/high/" class="nav-link">
  java进阶-JVM相关
</a></li></ul></li><li class="dropdown-item"><h4>
          C语言
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/10.语言/10.C/" class="nav-link">
  C语言基础
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="算法" class="dropdown-title"><span class="title">算法</span> <span class="arrow down"></span></button> <button type="button" aria-label="算法" class="mobile-dropdown-title"><span class="title">算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          算法基础
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/30.算法/01.算法基础/" class="nav-link">
  算法基础
</a></li><li class="dropdown-subitem"><a href="/90.%E5%B7%A5%E5%85%B7%E9%83%A8%E7%BD%B2/02.Nginx/notes/.html" class="nav-link">
  算法思想
</a></li></ul></li><li class="dropdown-item"><h4>
          其他算法
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/baodian/zero/" class="nav-link">
  头脑风暴
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow down"></span></button> <button type="button" aria-label="数据库" class="mobile-dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          数据库基础和原理
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/baodian/zero/" class="nav-link">
  数据库基础
</a></li><li class="dropdown-subitem"><a href="/baodian/high/" class="nav-link">
  SQL语言
</a></li></ul></li><li class="dropdown-item"><h4>
          SQL数据库
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/baodian/zero/" class="nav-link">
  Mysql详解
</a></li></ul></li><li class="dropdown-item"><h4>
          NoSQL数据库
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/baodian/zero/" class="nav-link">
  Redis详解
</a></li><li class="dropdown-subitem"><a href="/baodian/high/" class="nav-link">
  MongoDB详解
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架|中间件" class="dropdown-title"><span class="title">框架|中间件</span> <span class="arrow down"></span></button> <button type="button" aria-label="框架|中间件" class="mobile-dropdown-title"><span class="title">框架|中间件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          WEB容器
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/20.框架/01.Spring/" class="nav-link">
  Spring
</a></li><li class="dropdown-subitem"><a href="/20.框架/02.SpringMVC/" class="nav-link">
  SpringMVC
</a></li><li class="dropdown-subitem"><a href="/20.框架/04.SpringBoot/" class="nav-link">
  SpringBoot
</a></li></ul></li><li class="dropdown-item"><h4>
          ORM框架
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/20.框架/03.Mybatis/" class="nav-link">
  Mybatis
</a></li><li class="dropdown-subitem"><a href="/20.框架/04.MybatisPlus/" class="nav-link">
  MybatisPlus
</a></li></ul></li><li class="dropdown-item"><h4>
          前端
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/20.框架/05.VUE/" class="nav-link">
  VUE
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="408" class="dropdown-title"><span class="title">408</span> <span class="arrow down"></span></button> <button type="button" aria-label="408" class="mobile-dropdown-title"><span class="title">408</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          计算机组成原理
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/50.408/10.机组/" class="nav-link">
  计算机组成原理基础
</a></li></ul></li><li class="dropdown-item"><h4>
          计算机网络
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/50.408/00.网络/" class="nav-link">
  计算机网络基础
</a></li><li class="dropdown-subitem"><a href="/50.408/01.慕课29讲/" class="nav-link">
  慕课29讲
</a></li></ul></li><li class="dropdown-item"><h4>
          操作系统
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/20.框架/03.Mybatis/" class="nav-link">
  Mybatis
</a></li></ul></li><li class="dropdown-item"><h4>
          数据结构
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/20.框架/03.Mybatis/" class="nav-link">
  Mybatis
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目" class="dropdown-title"><span class="title">项目</span> <span class="arrow down"></span></button> <button type="button" aria-label="项目" class="mobile-dropdown-title"><span class="title">项目</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          入门 - 青铜阶段
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/80.项目/01.单体项目/" class="nav-link">
  单体项目
</a></li><li class="dropdown-subitem"><a href="/80.项目/02.微服务项目/" class="nav-link">
  微服务项目
</a></li></ul></li><li class="dropdown-item"><h4>
          进阶 - 白银阶段
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/20.框架/03.Mybatis/" class="nav-link">
  Mybatis
</a></li></ul></li><li class="dropdown-item"><h4>
          进阶 - 黄金阶段
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/20.框架/03.Mybatis/" class="nav-link">
  Mybatis
</a></li></ul></li><li class="dropdown-item"><h4>
          进阶 - 铂金阶段
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/20.框架/03.Mybatis/" class="nav-link">
  Mybatis
</a></li></ul></li><li class="dropdown-item"><h4>
          进阶 - 钻石阶段
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/20.框架/03.Mybatis/" class="nav-link">
  Mybatis
</a></li></ul></li><li class="dropdown-item"><h4>
          进阶 - 星耀阶段
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/20.框架/03.Mybatis/" class="nav-link">
  Mybatis
</a></li></ul></li><li class="dropdown-item"><h4>
          进阶 - 王者阶段
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/20.框架/03.Mybatis/" class="nav-link">
  Mybatis
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发" class="dropdown-title"><span class="title">开发</span> <span class="arrow down"></span></button> <button type="button" aria-label="开发" class="mobile-dropdown-title"><span class="title">开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/70.开发/01.开发BUG/" class="nav-link">
  开发BUG
</a></li><li class="dropdown-item"><!----> <a href="/baodian/high/" class="nav-link">
  中高进阶篇
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="方法论" class="dropdown-title"><span class="title">方法论</span> <span class="arrow down"></span></button> <button type="button" aria-label="方法论" class="mobile-dropdown-title"><span class="title">方法论</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          设计模式
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/60.方法论/01.设计模式/" class="nav-link">
  设计模式基础
</a></li></ul></li><li class="dropdown-item"><h4>
          理论|流程|协议
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/20.框架/03.Mybatis/" class="nav-link">
  Mybatis
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具|部署" class="dropdown-title"><span class="title">工具|部署</span> <span class="arrow down"></span></button> <button type="button" aria-label="工具|部署" class="mobile-dropdown-title"><span class="title">工具|部署</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/90.工具部署/01.Linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/90.工具部署/02.Nginx/" class="nav-link">
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/90.工具部署/03.Maven/" class="nav-link">
  Maven
</a></li><li class="dropdown-item"><!----> <a href="/90.工具部署/04.部署/" class="nav-link">
  部署
</a></li><li class="dropdown-item"><!----> <a href="/90.工具部署/05.工具/" class="nav-link">
  工具
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具箱" class="dropdown-title"><span class="title">工具箱</span> <span class="arrow down"></span></button> <button type="button" aria-label="工具箱" class="mobile-dropdown-title"><span class="title">工具箱</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          在线编辑
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://tinypng.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  图片压缩
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li><li class="dropdown-item"><h4>
          在线服务
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.aliyun.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  阿里云
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://cloud.tencent.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  腾讯云
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li><li class="dropdown-item"><h4>
          博客指南
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://juejin.im/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://blog.csdn.net/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="语言" class="dropdown-title"><span class="title">语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="语言" class="mobile-dropdown-title"><span class="title">语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          java
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/baodian/zero/" class="nav-link">
  面向对象基础
</a></li><li class="dropdown-subitem"><a href="/baodian/high/" class="nav-link">
  java进阶-集合框架
</a></li><li class="dropdown-subitem"><a href="/baodian/high/" class="nav-link">
  java进阶-并发框架
</a></li><li class="dropdown-subitem"><a href="/baodian/high/" class="nav-link">
  java进阶-IO框架
</a></li><li class="dropdown-subitem"><a href="/baodian/high/" class="nav-link">
  java进阶-新版本特性
</a></li><li class="dropdown-subitem"><a href="/baodian/high/" class="nav-link">
  java进阶-JVM相关
</a></li></ul></li><li class="dropdown-item"><h4>
          C语言
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/10.语言/10.C/" class="nav-link">
  C语言基础
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="算法" class="dropdown-title"><span class="title">算法</span> <span class="arrow down"></span></button> <button type="button" aria-label="算法" class="mobile-dropdown-title"><span class="title">算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          算法基础
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/30.算法/01.算法基础/" class="nav-link">
  算法基础
</a></li><li class="dropdown-subitem"><a href="/90.%E5%B7%A5%E5%85%B7%E9%83%A8%E7%BD%B2/02.Nginx/notes/.html" class="nav-link">
  算法思想
</a></li></ul></li><li class="dropdown-item"><h4>
          其他算法
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/baodian/zero/" class="nav-link">
  头脑风暴
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow down"></span></button> <button type="button" aria-label="数据库" class="mobile-dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          数据库基础和原理
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/baodian/zero/" class="nav-link">
  数据库基础
</a></li><li class="dropdown-subitem"><a href="/baodian/high/" class="nav-link">
  SQL语言
</a></li></ul></li><li class="dropdown-item"><h4>
          SQL数据库
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/baodian/zero/" class="nav-link">
  Mysql详解
</a></li></ul></li><li class="dropdown-item"><h4>
          NoSQL数据库
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/baodian/zero/" class="nav-link">
  Redis详解
</a></li><li class="dropdown-subitem"><a href="/baodian/high/" class="nav-link">
  MongoDB详解
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架|中间件" class="dropdown-title"><span class="title">框架|中间件</span> <span class="arrow down"></span></button> <button type="button" aria-label="框架|中间件" class="mobile-dropdown-title"><span class="title">框架|中间件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          WEB容器
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/20.框架/01.Spring/" class="nav-link">
  Spring
</a></li><li class="dropdown-subitem"><a href="/20.框架/02.SpringMVC/" class="nav-link">
  SpringMVC
</a></li><li class="dropdown-subitem"><a href="/20.框架/04.SpringBoot/" class="nav-link">
  SpringBoot
</a></li></ul></li><li class="dropdown-item"><h4>
          ORM框架
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/20.框架/03.Mybatis/" class="nav-link">
  Mybatis
</a></li><li class="dropdown-subitem"><a href="/20.框架/04.MybatisPlus/" class="nav-link">
  MybatisPlus
</a></li></ul></li><li class="dropdown-item"><h4>
          前端
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/20.框架/05.VUE/" class="nav-link">
  VUE
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="408" class="dropdown-title"><span class="title">408</span> <span class="arrow down"></span></button> <button type="button" aria-label="408" class="mobile-dropdown-title"><span class="title">408</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          计算机组成原理
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/50.408/10.机组/" class="nav-link">
  计算机组成原理基础
</a></li></ul></li><li class="dropdown-item"><h4>
          计算机网络
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/50.408/00.网络/" class="nav-link">
  计算机网络基础
</a></li><li class="dropdown-subitem"><a href="/50.408/01.慕课29讲/" class="nav-link">
  慕课29讲
</a></li></ul></li><li class="dropdown-item"><h4>
          操作系统
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/20.框架/03.Mybatis/" class="nav-link">
  Mybatis
</a></li></ul></li><li class="dropdown-item"><h4>
          数据结构
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/20.框架/03.Mybatis/" class="nav-link">
  Mybatis
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目" class="dropdown-title"><span class="title">项目</span> <span class="arrow down"></span></button> <button type="button" aria-label="项目" class="mobile-dropdown-title"><span class="title">项目</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          入门 - 青铜阶段
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/80.项目/01.单体项目/" class="nav-link">
  单体项目
</a></li><li class="dropdown-subitem"><a href="/80.项目/02.微服务项目/" class="nav-link">
  微服务项目
</a></li></ul></li><li class="dropdown-item"><h4>
          进阶 - 白银阶段
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/20.框架/03.Mybatis/" class="nav-link">
  Mybatis
</a></li></ul></li><li class="dropdown-item"><h4>
          进阶 - 黄金阶段
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/20.框架/03.Mybatis/" class="nav-link">
  Mybatis
</a></li></ul></li><li class="dropdown-item"><h4>
          进阶 - 铂金阶段
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/20.框架/03.Mybatis/" class="nav-link">
  Mybatis
</a></li></ul></li><li class="dropdown-item"><h4>
          进阶 - 钻石阶段
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/20.框架/03.Mybatis/" class="nav-link">
  Mybatis
</a></li></ul></li><li class="dropdown-item"><h4>
          进阶 - 星耀阶段
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/20.框架/03.Mybatis/" class="nav-link">
  Mybatis
</a></li></ul></li><li class="dropdown-item"><h4>
          进阶 - 王者阶段
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/20.框架/03.Mybatis/" class="nav-link">
  Mybatis
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发" class="dropdown-title"><span class="title">开发</span> <span class="arrow down"></span></button> <button type="button" aria-label="开发" class="mobile-dropdown-title"><span class="title">开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/70.开发/01.开发BUG/" class="nav-link">
  开发BUG
</a></li><li class="dropdown-item"><!----> <a href="/baodian/high/" class="nav-link">
  中高进阶篇
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="方法论" class="dropdown-title"><span class="title">方法论</span> <span class="arrow down"></span></button> <button type="button" aria-label="方法论" class="mobile-dropdown-title"><span class="title">方法论</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          设计模式
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/60.方法论/01.设计模式/" class="nav-link">
  设计模式基础
</a></li></ul></li><li class="dropdown-item"><h4>
          理论|流程|协议
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/20.框架/03.Mybatis/" class="nav-link">
  Mybatis
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具|部署" class="dropdown-title"><span class="title">工具|部署</span> <span class="arrow down"></span></button> <button type="button" aria-label="工具|部署" class="mobile-dropdown-title"><span class="title">工具|部署</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/90.工具部署/01.Linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/90.工具部署/02.Nginx/" class="nav-link">
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/90.工具部署/03.Maven/" class="nav-link">
  Maven
</a></li><li class="dropdown-item"><!----> <a href="/90.工具部署/04.部署/" class="nav-link">
  部署
</a></li><li class="dropdown-item"><!----> <a href="/90.工具部署/05.工具/" class="nav-link">
  工具
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具箱" class="dropdown-title"><span class="title">工具箱</span> <span class="arrow down"></span></button> <button type="button" aria-label="工具箱" class="mobile-dropdown-title"><span class="title">工具箱</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          在线编辑
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://tinypng.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  图片压缩
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li><li class="dropdown-item"><h4>
          在线服务
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.aliyun.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  阿里云
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://cloud.tencent.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  腾讯云
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li><li class="dropdown-item"><h4>
          博客指南
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://juejin.im/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://blog.csdn.net/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>nginx</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/90.工具部署/02.Nginx/notes/1Nginx.html" class="active sidebar-link">Nginx总结</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/90.工具部署/02.Nginx/notes/1Nginx.html#_1-什么是nginx" class="sidebar-link">1. 什么是Nginx?</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/90.工具部署/02.Nginx/notes/1Nginx.html#_1-1-正向代理" class="sidebar-link">1.1 正向代理</a></li><li class="sidebar-sub-header"><a href="/90.工具部署/02.Nginx/notes/1Nginx.html#_1-2-反向代理" class="sidebar-link">1.2 反向代理</a></li><li class="sidebar-sub-header"><a href="/90.工具部署/02.Nginx/notes/1Nginx.html#_1-3-正向代理与反向代理的应用场景" class="sidebar-link">1.3 正向代理与反向代理的应用场景</a></li><li class="sidebar-sub-header"><a href="/90.工具部署/02.Nginx/notes/1Nginx.html#_1-4-正向代理与反向代理的区别" class="sidebar-link">1.4 正向代理与反向代理的区别</a></li><li class="sidebar-sub-header"><a href="/90.工具部署/02.Nginx/notes/1Nginx.html#_1-5-负载均衡" class="sidebar-link">1.5 负载均衡</a></li><li class="sidebar-sub-header"><a href="/90.工具部署/02.Nginx/notes/1Nginx.html#_1-6-动静分离" class="sidebar-link">1.6 动静分离</a></li><li class="sidebar-sub-header"><a href="/90.工具部署/02.Nginx/notes/1Nginx.html#_1-7-几种常用web服务器对比" class="sidebar-link">1.7 几种常用web服务器对比</a></li></ul></li><li class="sidebar-sub-header"><a href="/90.工具部署/02.Nginx/notes/1Nginx.html#_2-linux安装nginx" class="sidebar-link">2. Linux安装Nginx</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/90.工具部署/02.Nginx/notes/1Nginx.html#安装-nginx-前-必须安装-pcre-ubuntu操作系统的时候" class="sidebar-link">安装 Nginx 前 必须安装 PCRE（Ubuntu操作系统的时候）</a></li><li class="sidebar-sub-header"><a href="/90.工具部署/02.Nginx/notes/1Nginx.html#安装nginx" class="sidebar-link">安装Nginx</a></li><li class="sidebar-sub-header"><a href="/90.工具部署/02.Nginx/notes/1Nginx.html#开启防火墙" class="sidebar-link">开启防火墙</a></li><li class="sidebar-sub-header"><a href="/90.工具部署/02.Nginx/notes/1Nginx.html#centos-安装-nginx" class="sidebar-link">CentOS 安装 Nginx</a></li></ul></li><li class="sidebar-sub-header"><a href="/90.工具部署/02.Nginx/notes/1Nginx.html#_3-nginx常用命令" class="sidebar-link">3. Nginx常用命令</a></li><li class="sidebar-sub-header"><a href="/90.工具部署/02.Nginx/notes/1Nginx.html#_4-nginx配置文件" class="sidebar-link">4. Nginx配置文件</a></li><li class="sidebar-sub-header"><a href="/90.工具部署/02.Nginx/notes/1Nginx.html#_5-配置反向代理" class="sidebar-link">5. 配置反向代理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/90.工具部署/02.Nginx/notes/1Nginx.html#案例一" class="sidebar-link">案例一：</a></li><li class="sidebar-sub-header"><a href="/90.工具部署/02.Nginx/notes/1Nginx.html#_5-2-案例二" class="sidebar-link">5.2 案例二</a></li><li class="sidebar-sub-header"><a href="/90.工具部署/02.Nginx/notes/1Nginx.html#_5-3-安装成系统服务-开机自启" class="sidebar-link">5.3 安装成系统服务，开机自启</a></li><li class="sidebar-sub-header"><a href="/90.工具部署/02.Nginx/notes/1Nginx.html#_5-4-启动与关闭-nginx" class="sidebar-link">5.4 启动与关闭 nginx</a></li><li class="sidebar-sub-header"><a href="/90.工具部署/02.Nginx/notes/1Nginx.html#nginx-配置环境变量" class="sidebar-link">nginx 配置环境变量</a></li></ul></li></ul></li><li><a href="/90.工具部署/02.Nginx/notes/2Nginx基础.html" class="sidebar-link">Nginx尚硅谷</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="_1-什么是nginx"><a href="#_1-什么是nginx" class="header-anchor">#</a> 1. 什么是Nginx?</h2> <p>Nginx (engine x) 是一个高性能的HTTP和反向代理web服务器，同时也提供了IMAP/POP3/SMTP服务。</p> <p>Nginx是由伊戈尔·赛索耶夫为俄罗斯访问量第二的Rambler.ru站点（俄文：Рамблер）开发的。</p> <p>Nginx的特点是占有内存少，并发能力强，能够支持高达 50,000 个并发连接数的响应,事实上nginx的并发能力在同类型的网页服务器中表现较好，中国大陆使用nginx网站用户有：百度、京东、新浪、网易、腾讯、淘宝等。</p> <p>Nginx支持正向代理、反向代理、负载均衡和动静分离。接下来一一介绍。</p> <h3 id="_1-1-正向代理"><a href="#_1-1-正向代理" class="header-anchor">#</a> 1.1 正向代理</h3> <p>在如今的网络环境下，我们如果由于技术需要要去访问国外的某些网站，此时你会发现位于国外的某网站我们通过浏览器是没有办法访问的，此时大家可能都会用一个代理(vpn)进行访问，代理的方式主要是找到一个可以访问国外网站的代理服务器，我们将请求发送给代理服务器，代理服务器去访问国外的网站，然后将访问到的数据传递给我们！</p> <p>Nginx支持正向代理，&quot;它代理的是客户端&quot;，是一个位于客户端和原始服务器(origin server)之间的服务器，为了从原始服务器取得内容，客户端向代理发送一个请求并指定目标(原始服务器)，然后代理向原始服务器转交请求并将获得的内容返回给客户端。客户端必须要进行一些特别的设置才能使用正向代理。</p> <p><img src="https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-a4c65b10c74e4442bec396fea227119c.png" alt="image.png"></p> <p>客户端必须设置正向代理服务器，当然前提是要知道正向代理服务器的IP地址，还有代理程序的端口。如图。
<img src="https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-124e8ff675114c1cb93416f1fe30c912.png" alt="image.png"></p> <p><img src="https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-1c89f0a0fed742e7868b4852262709bb.png" alt="image.png"> <strong>正向代理的用途：</strong>
（1）访问原来无法访问的资源，如Google
（2） 可以做缓存，加速访问资源
（3）对客户端访问授权，上网进行认证
（4）代理可以记录用户访问记录（上网行为管理），对外隐藏用户信息</p> <h3 id="_1-2-反向代理"><a href="#_1-2-反向代理" class="header-anchor">#</a> 1.2 反向代理</h3> <p>明白了什么是正向代理，我们继续看关于反向代理的处理方式，举例如我大天朝的某宝网站，每天同时连接到网站的访问人数已经爆表，单个服务器远远不能满足人民日益增长的购买欲望了，此时就出现了一个大家耳熟能详的名词：分布式部署；也就是通过部署多台服务器来解决访问人数限制的问题；某宝网站中大部分功能也是直接使用Nginx进行反向代理实现的，并且通过封装Nginx和其他的组件之后起了个高大上的名字：Tengine，有兴趣的童鞋可以访问Tengine的官网查看具体的信息：http://tengine.taobao.org/。</p> <p>Tengine是一个由淘宝网发起的Web服务器开源项目，其核心成员来自于淘宝 、搜狗 等互联网企业。它在Nginx 的基础上，针对大访问量网站的需求，添加了很多高级功能和特性。Tengine的性能和稳定性已经在大型的网站如淘宝网 ，天猫商城 等得到了很好的检验。它的最终目标是打造一个高效、稳定、安全、易用的Web平台。</p> <p>Nginx支持<strong>反向代理</strong>，&quot;它代理的是服务端，代服务端接收请求&quot;，主要用于服务器集群分布式部署的情况下，<strong>反向代理隐藏了服务器的信息</strong>。多个客户端给服务器发送的请求，Nginx服务器接收到之后，按照一定的规则分发给了后端的业务处理服务器进行处理了。请求的来源也就是客户端是明确的，但是请求具体由哪台服务器处理的并不明确了，Nginx扮演的就是一个反向代理角色。
<img src="https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-ca93743096534d1282c0b7a53ebf893b.png" alt="image.png"></p> <p>反向代理的作用：
（1）保证内网的安全，通常将反向代理作为公网访问地址，Web服务器是内网。
（2）负载均衡，通过反向代理服务器来优化网站的负载</p> <h3 id="_1-3-正向代理与反向代理的应用场景"><a href="#_1-3-正向代理与反向代理的应用场景" class="header-anchor">#</a> 1.3 正向代理与反向代理的应用场景</h3> <p>通常情况下，我们在实际项目操作时，正向代理和反向代理很有可能会存在在<strong>一个应用场景中</strong>，正向代理代理客户端的请求去访问目标服务器，目标服务器是一个反向代理服务器，反向代理了多台真实的业务处理服务器。具体的拓扑图如下：</p> <h3 id="_1-4-正向代理与反向代理的区别"><a href="#_1-4-正向代理与反向代理的区别" class="header-anchor">#</a> 1.4 正向代理与反向代理的区别</h3> <p>通过一张图来说明正向代理和反向代理二者之间的区别：
<img src="https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-0a22e070bcb14d2caf1a4ffd868f3b5c.png" alt="image.png">
图解：</p> <p>在正向代理中，Proxy和Client同属于一个LAN（图中方框内），隐藏了客户端信息；</p> <p>在反向代理中，Proxy和Server同属于一个LAN（图中方框内），隐藏了服务端信息；</p> <p>实际上，Proxy在两种代理中做的事情都是替服务器代为收发请求和响应，不过从结构上看正好左右互换了一下，所以把后出现的那种代理方式称为反向代理了。</p> <h3 id="_1-5-负载均衡"><a href="#_1-5-负载均衡" class="header-anchor">#</a> 1.5 负载均衡</h3> <p>我们已经明确了所谓代理服务器的概念，那么接下来，Nginx扮演了反向代理服务器的角色，它是以依据什么样的规则进行请求分发的呢？不用的项目应用场景，分发的规则是否可以控制呢？</p> <p>我们把客户端发送的、Nginx反向代理服务器接收到的<strong>请求数量</strong>，就是我们说的<strong>负载量</strong>。</p> <p>请求数量按照一定的规则进行分发到不同的服务器处理的规则，就是一种均衡规则。</p> <p>将服务器接收到的请求按照规则分发的过程，称为<strong>负载均衡</strong>。</p> <p>负载均衡在实际项目操作过程中，有<strong>硬件</strong>负载均衡和<strong>软件</strong>负载均衡两种，硬件负载均衡也称为硬负载，如F5负载均衡，相对造价昂贵成本较高，但是数据的<strong>稳定性安全性</strong>等等有非常好的保障，如中国移动中国联通这样的公司才会选择硬负载进行操作；更多的公司考虑到成本原因，会选择使用软件负载均衡，软件负载均衡是利用现有的技术结合主机硬件实现的一种<strong>消息队列分发机制</strong>。
<img src="https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-04a855b232244076a48e57536f1a6e13.png" alt="image.png">
Nginx支持的负载均衡调度算法方式如下：</p> <ol><li>weight轮询（默认，常用，具有HA功效！）：接收到的请求按照权重分配到不同的后端服务器，即使在使用过程中，某一台后端服务器宕机，Nginx会自动将该服务器剔除出队列，请求受理情况不会受到任何影响。 这种方式下，可以给不同的后端服务器设置一个权重值(weight)，用于调整不同的服务器上请求的分配率；权重数据越大，被分配到请求的几率越大；该权重值，主要是针对实际工作环境中不同的后端服务器硬件配置进行调整的。</li> <li>ip_hash（常用）：每个请求按访问ip的hash结果分配，这样每个访客固定访问一个后端服务器，这也在一定程度上解决了集群部署环境下session共享的问题。</li> <li>fair：智能调整调度算法，动态的根据后端服务器的请求处理到响应的时间进行均衡分配，响应时间短处理效率高的服务器分配到请求的概率高，响应时间长处理效率低的服务器分配到的请求少；结合了前两者的优点的一种调度算法。但是需要注意的是Nginx默认不支持fair算法，如果要使用这种调度算法，请安装upstream_fair模块。</li> <li>url_hash：按照访问的url的hash结果分配请求，每个请求的url会指向后端固定的某个服务器，可以在Nginx作为静态服务器的情况下提高缓存效率。同样要注意Nginx默认不支持这种调度算法，要使用的话需要安装Nginx的hash软件包。</li></ol> <h3 id="_1-6-动静分离"><a href="#_1-6-动静分离" class="header-anchor">#</a> 1.6 动静分离</h3> <p>为了提高网站的响应速度，减轻程序服务器（Tomcat，Jboss等）的负载，对于静态资源比如图片，js，css等文件，我们可以在Nginx反向代理服务器中进行缓存，这样浏览器在请求一个静态资源时，Nginx代理服务器就可以直接处理，而不用将请求转发给后端服务器。用户请求的动态文件比如<strong>servlet,jsp则转发给Tomcat</strong>，Jboss服务器处理，这就是<strong>动静分离</strong>。
<img src="https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-d7225c6b2a28482bafaf8324f5ff992a.png" alt="image.png"></p> <h3 id="_1-7-几种常用web服务器对比"><a href="#_1-7-几种常用web服务器对比" class="header-anchor">#</a> 1.7 几种常用web服务器对比</h3> <p><img src="https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-d91615408a1b44bdaeefc596f0198d52.png" alt="image.png"></p> <h2 id="_2-linux安装nginx"><a href="#_2-linux安装nginx" class="header-anchor">#</a> 2. Linux安装Nginx</h2> <h3 id="安装-nginx-前-必须安装-pcre-ubuntu操作系统的时候"><a href="#安装-nginx-前-必须安装-pcre-ubuntu操作系统的时候" class="header-anchor">#</a> 安装 Nginx 前 必须安装 PCRE（Ubuntu操作系统的时候）</h3> <p>Nginx是高度自由化的Web服务器，它的功能是由许多模块来支持。如果使用了某个模块，这个模块使用了一些类似zlib或OpenSSL等的第三方库，那么就必须先安装这些软件。Ubuntu下不像在centOS中使用yum直接在线安装，可以使用以下方法。</p> <h4 id="_1-pcre库"><a href="#_1-pcre库" class="header-anchor">#</a> （1）PCRE库</h4> <p>PCRE库支持正则表达式。如果我们在配置文件nginx.conf中使用了正则表达式，那么在编译Nginx时就必须把PCRE库编译进Nginx，因为Nginx的HTTP模块需要靠它来解析正则表达式。另外，pcre-devel是使用PCRE做二次开发时所需要的开发库，包括头文件等，这也是编译Nginx所必须使用的。可以这样安装：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>
sudo apt<span class="token operator">-</span>get install libpcre3 libpcre3<span class="token operator">-</span>dev  

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_2-zlib库"><a href="#_2-zlib库" class="header-anchor">#</a> （2）zlib库</h4> <p>zlib库用于对HTTP包的内容做gzip格式的压缩，如果我们在nginx.conf中配置了gzip on，并指定对于某些类型（content-type）的HTTP响应使用gzip来进行压缩以减少网络传输量，则在编译时就必须把zlib编译进Nginx。zlib-devel是二次开发所需要的库。可以这样安装：</p> <p>sudo apt-get install zlib1g-dev</p> <h4 id="_3-openssl库"><a href="#_3-openssl库" class="header-anchor">#</a> （3）OpenSSL库</h4> <p>如果服务器不只是要支持HTTP，还需要在更安全的SSL协议上传输HTTP，那么需要拥有OpenSSL。另外，如果我们想使用MD5、SHA1等散列函数，那么也需要安装它。可以这样安装：</p> <p>sudo apt-get install openssl libssl-dev
网址：https://blog.csdn.net/somanlee/article/details/69808788?utm_source=copy</p> <p>最好在更新一下 openssl</p> <p>但是升级了 openssl nginx 安装 --with-http_ssl_module 会报错 （所以我 为了开启 --with-http_ssl_module 没有升级 openssl 不升级也没什么关系 哈哈哈）</p> <p>不升级  openssl  能正常编译安装 nginx --with-http_ssl_module   切记切记</p> <h3 id="安装nginx"><a href="#安装nginx" class="header-anchor">#</a> 安装Nginx</h3> <p>下载地址：https://nginx.org/en/download.html</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token punctuation">[</span>root<span class="token annotation punctuation">@centos7601</span> nginx<span class="token punctuation">]</span># wget https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>nginx<span class="token punctuation">.</span>org<span class="token operator">/</span>download<span class="token operator">/</span>nginx<span class="token operator">-</span><span class="token number">1.18</span><span class="token number">.0</span><span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@centos7601</span> nginx<span class="token punctuation">]</span># ll
总用量 <span class="token number">3072</span>
<span class="token operator">-</span>rw<span class="token operator">-</span>r<span class="token operator">--</span>r<span class="token operator">--</span><span class="token punctuation">.</span> <span class="token number">1</span> root root <span class="token number">2090750</span> <span class="token number">2</span>月  <span class="token number">13</span> <span class="token number">2020</span> download
<span class="token operator">-</span>rw<span class="token operator">-</span>r<span class="token operator">--</span>r<span class="token operator">--</span><span class="token punctuation">.</span> <span class="token number">1</span> root root <span class="token number">1039530</span> <span class="token number">4</span>月  <span class="token number">21</span> <span class="token number">2020</span> nginx<span class="token operator">-</span><span class="token number">1.18</span><span class="token number">.0</span><span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz
drwxr<span class="token operator">-</span>xr<span class="token operator">-</span>x<span class="token punctuation">.</span> <span class="token number">9</span> <span class="token number">1169</span> <span class="token number">1169</span>   <span class="token number">12288</span> <span class="token number">2</span>月  <span class="token number">28</span> <span class="token number">15</span><span class="token operator">:</span><span class="token number">39</span> pcre<span class="token operator">-</span><span class="token number">8.44</span>
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@centos7601</span> nginx<span class="token punctuation">]</span># tar <span class="token operator">-</span>zxvf nginx<span class="token operator">-</span><span class="token number">1.18</span><span class="token number">.0</span><span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz 
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@centos7601</span> nginx<span class="token punctuation">]</span># ll
总用量 <span class="token number">3076</span>
<span class="token operator">-</span>rw<span class="token operator">-</span>r<span class="token operator">--</span>r<span class="token operator">--</span><span class="token punctuation">.</span> <span class="token number">1</span> root root <span class="token number">2090750</span> <span class="token number">2</span>月  <span class="token number">13</span> <span class="token number">2020</span> download
drwxr<span class="token operator">-</span>xr<span class="token operator">-</span>x<span class="token punctuation">.</span> <span class="token number">8</span> <span class="token number">1001</span> <span class="token number">1001</span>    <span class="token number">4096</span> <span class="token number">4</span>月  <span class="token number">21</span> <span class="token number">2020</span> nginx<span class="token operator">-</span><span class="token number">1.18</span><span class="token number">.0</span>
<span class="token operator">-</span>rw<span class="token operator">-</span>r<span class="token operator">--</span>r<span class="token operator">--</span><span class="token punctuation">.</span> <span class="token number">1</span> root root <span class="token number">1039530</span> <span class="token number">4</span>月  <span class="token number">21</span> <span class="token number">2020</span> nginx<span class="token operator">-</span><span class="token number">1.18</span><span class="token number">.0</span><span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz
drwxr<span class="token operator">-</span>xr<span class="token operator">-</span>x<span class="token punctuation">.</span> <span class="token number">9</span> <span class="token number">1169</span> <span class="token number">1169</span>   <span class="token number">12288</span> <span class="token number">2</span>月  <span class="token number">28</span> <span class="token number">15</span><span class="token operator">:</span><span class="token number">39</span> pcre<span class="token operator">-</span><span class="token number">8.44</span>
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@centos7601</span> nginx<span class="token punctuation">]</span># cd nginx<span class="token operator">-</span><span class="token number">1.18</span><span class="token number">.0</span><span class="token operator">/</span>
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@centos7601</span> nginx<span class="token operator">-</span><span class="token number">1.18</span><span class="token number">.0</span><span class="token punctuation">]</span># <span class="token punctuation">.</span>/configure 
# 安装成功之后，在<span class="token operator">/</span>usr下多出来一个文件夹local<span class="token operator">/</span>nginx，在<span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>sbin有启动脚本 一定要在<span class="token operator">/</span>url中修改否则不生效
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@centos7601</span> sbin<span class="token punctuation">]</span># pwd
<span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>sbin
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@centos7601</span> sbin<span class="token punctuation">]</span># ll
总用量 <span class="token number">3764</span>
<span class="token operator">-</span>rwxr<span class="token operator">-</span>xr<span class="token operator">-</span>x<span class="token punctuation">.</span> <span class="token number">1</span> root root <span class="token number">3852280</span> <span class="token number">2</span>月  <span class="token number">28</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">01</span> nginx
# 启动nginx
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@centos7601</span> sbin<span class="token punctuation">]</span># <span class="token punctuation">.</span>/nginx
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@centos7601</span> sbin<span class="token punctuation">]</span># ps <span class="token operator">-</span>ef <span class="token operator">|</span>grep nginx
root      <span class="token number">60890</span>      <span class="token number">1</span>  <span class="token number">0</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">05</span> <span class="token operator">?</span>        <span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span> nginx<span class="token operator">:</span> master process <span class="token punctuation">.</span>/nginx
nobody    <span class="token number">60892</span>  <span class="token number">60890</span>  <span class="token number">0</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">05</span> <span class="token operator">?</span>        <span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span> nginx<span class="token operator">:</span> worker process
root      <span class="token number">60907</span> <span class="token number">127532</span>  <span class="token number">0</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">05</span> pts<span class="token operator">/</span><span class="token number">3</span>    <span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span> grep <span class="token operator">--</span>color<span class="token operator">=</span>auto nginx
# 测试<span class="token class-name">Nginx</span>是否成功，查看ip，然后网址输入ip地址可转到一个<span class="token class-name">Nginx</span>测试网页，这里只展示部分命令结果
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@centos7601</span> sbin<span class="token punctuation">]</span># ifconfig
ens33<span class="token operator">:</span> flags<span class="token operator">=</span><span class="token number">4163</span><span class="token generics"><span class="token punctuation">&lt;</span>UP<span class="token punctuation">,</span>BROADCAST<span class="token punctuation">,</span>RUNNING<span class="token punctuation">,</span>MULTICAST<span class="token punctuation">&gt;</span></span>  mtu <span class="token number">1500</span>
        inet <span class="token number">192.168</span><span class="token number">.14</span><span class="token number">.128</span>  netmask <span class="token number">255.255</span><span class="token number">.255</span><span class="token number">.0</span>  broadcast <span class="token number">192.168</span><span class="token number">.14</span><span class="token number">.255</span>
        inet6 fe80<span class="token operator">::</span><span class="token number">9</span>eb2<span class="token operator">:</span>b749<span class="token operator">:</span>c806<span class="token operator">:</span><span class="token number">4</span>c97  prefixlen <span class="token number">64</span>  scopeid <span class="token number">0x20</span><span class="token generics"><span class="token punctuation">&lt;</span>link<span class="token punctuation">&gt;</span></span>
        ether <span class="token number">00</span><span class="token operator">:</span><span class="token number">0</span>c<span class="token operator">:</span><span class="token number">29</span><span class="token operator">:</span><span class="token number">61</span><span class="token operator">:</span><span class="token number">23</span><span class="token operator">:</span><span class="token number">1</span>e  txqueuelen <span class="token number">1000</span>  <span class="token punctuation">(</span><span class="token class-name">Ethernet</span><span class="token punctuation">)</span>
        RX packets <span class="token number">507925</span>  bytes <span class="token number">738941851</span> <span class="token punctuation">(</span><span class="token number">704.7</span> <span class="token class-name">MiB</span><span class="token punctuation">)</span>
        RX errors <span class="token number">0</span>  dropped <span class="token number">0</span>  overruns <span class="token number">0</span>  frame <span class="token number">0</span>
        TX packets <span class="token number">158188</span>  bytes <span class="token number">10510448</span> <span class="token punctuation">(</span><span class="token number">10.0</span> <span class="token class-name">MiB</span><span class="token punctuation">)</span>
        TX errors <span class="token number">0</span>  dropped <span class="token number">0</span> overruns <span class="token number">0</span>  carrier <span class="token number">0</span>  collisions <span class="token number">0</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><h3 id="开启防火墙"><a href="#开启防火墙" class="header-anchor">#</a> 开启防火墙</h3> <p>nginx默认是监听80 端口；</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>
# 由于我的<span class="token class-name">Linxu</span>虚拟机<span class="token number">80</span>端口未开，所以需要对防火墙进行配置
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@centos7601</span> sbin<span class="token punctuation">]</span># firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>list<span class="token operator">-</span>all
<span class="token keyword">public</span> <span class="token punctuation">(</span>active<span class="token punctuation">)</span>
  target<span class="token operator">:</span> <span class="token keyword">default</span>
  icmp<span class="token operator">-</span>block<span class="token operator">-</span>inversion<span class="token operator">:</span> no
  interfaces<span class="token operator">:</span> ens33
  sources<span class="token operator">:</span> 
  services<span class="token operator">:</span> ssh dhcpv6<span class="token operator">-</span>client
  ports<span class="token operator">:</span> <span class="token number">8080</span><span class="token operator">/</span>tcp
  protocols<span class="token operator">:</span> 
  masquerade<span class="token operator">:</span> no
  forward<span class="token operator">-</span>ports<span class="token operator">:</span> 
  source<span class="token operator">-</span>ports<span class="token operator">:</span> 
  icmp<span class="token operator">-</span>blocks<span class="token operator">:</span> 
  rich rules<span class="token operator">:</span> 
	
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@centos7601</span> sbin<span class="token punctuation">]</span># firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>permanent <span class="token operator">--</span>add<span class="token operator">-</span>port<span class="token operator">=</span><span class="token number">80</span><span class="token operator">/</span>tcp
success
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@centos7601</span> sbin<span class="token punctuation">]</span># firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>reload
success
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@centos7601</span> sbin<span class="token punctuation">]</span># firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>query<span class="token operator">-</span>port<span class="token operator">=</span><span class="token number">80</span><span class="token operator">/</span>tcp
yes
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@centos7601</span> sbin<span class="token punctuation">]</span># firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>list<span class="token operator">-</span>all
<span class="token keyword">public</span> <span class="token punctuation">(</span>active<span class="token punctuation">)</span>
  target<span class="token operator">:</span> <span class="token keyword">default</span>
  icmp<span class="token operator">-</span>block<span class="token operator">-</span>inversion<span class="token operator">:</span> no
  interfaces<span class="token operator">:</span> ens33
  sources<span class="token operator">:</span> 
  services<span class="token operator">:</span> ssh dhcpv6<span class="token operator">-</span>client
  ports<span class="token operator">:</span> <span class="token number">8080</span><span class="token operator">/</span>tcp <span class="token number">80</span><span class="token operator">/</span>tcp
  protocols<span class="token operator">:</span> 
  masquerade<span class="token operator">:</span> no
  forward<span class="token operator">-</span>ports<span class="token operator">:</span> 
  source<span class="token operator">-</span>ports<span class="token operator">:</span> 
  icmp<span class="token operator">-</span>blocks<span class="token operator">:</span> 
  rich rules<span class="token operator">:</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-537aa61f3353459bad9390263b47c835.png" alt="image.png"></p> <p><img src="https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-1d64c05e37384ae89edf034ca80cf2cc.png" alt="image.png"></p> <h3 id="centos-安装-nginx"><a href="#centos-安装-nginx" class="header-anchor">#</a> CentOS 安装 Nginx</h3> <h4 id="a-依赖环境安装"><a href="#a-依赖环境安装" class="header-anchor">#</a> A. 依赖环境安装</h4> <p>要安装 nginx，要先安装 nginx 的依赖环境：gcc-c++、openssl、pcre、zlib</p> <h5 id="_1-安装-gcc-c-编译器和-openssl"><a href="#_1-安装-gcc-c-编译器和-openssl" class="header-anchor">#</a> 1. 安装 gcc-c++ 编译器和 openssl</h5> <div class="language-java line-numbers-mode"><pre class="language-java"><code>
yum install gcc<span class="token operator">-</span>c<span class="token operator">++</span> 
yum install <span class="token operator">-</span>y openssl openssl<span class="token operator">-</span>devel

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h5 id="_2-安装-pcre-包"><a href="#_2-安装-pcre-包" class="header-anchor">#</a> 2. 安装 pcre 包</h5> <p>yum install -y pcre pcre-devel</p> <h5 id="_3-再安装-zlib-包"><a href="#_3-再安装-zlib-包" class="header-anchor">#</a> 3. 再安装 zlib 包</h5> <p>yum install -y zlib zlib-devel</p> <h4 id="b-nginx-安装"><a href="#b-nginx-安装" class="header-anchor">#</a> B. Nginx 安装</h4> <p>依赖环境安装完成后，我们开始安装 nginx</p> <h5 id="_1-在-usr-local-目录下创建-nginx-文件夹"><a href="#_1-在-usr-local-目录下创建-nginx-文件夹" class="header-anchor">#</a> 1. 在 /usr/local/ 目录下创建 nginx 文件夹</h5> <p>cd /usr/local
mkdir nginx</p> <h5 id="_2-使用-wget-命令直接下载-nginx-安装包-也可以直接上传下载好的压缩包"><a href="#_2-使用-wget-命令直接下载-nginx-安装包-也可以直接上传下载好的压缩包" class="header-anchor">#</a> 2. 使用 wget 命令直接下载 nginx 安装包，也可以直接上传下载好的压缩包</h5> <p>wget https://nginx.org/download/nginx-1.14.0.tar.gz</p> <h5 id="_3-解压并进入解压好的目录"><a href="#_3-解压并进入解压好的目录" class="header-anchor">#</a> 3. 解压并进入解压好的目录</h5> <p>tar -zxvf nginx-1.14.0.tar.gz
cd nginx-1.14.0/</p> <h5 id="_4-使用-nginx-默认配置"><a href="#_4-使用-nginx-默认配置" class="header-anchor">#</a> 4. 使用 nginx 默认配置</h5> <p>./configure</p> <h5 id="_5-编译安装"><a href="#_5-编译安装" class="header-anchor">#</a> 5. 编译安装</h5> <p>make
make install</p> <p>如果没有报错，那么你的 /usr/local/nginx目录会多些除了红框之外的东西如下
<img src="https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-6249509ddca04ee9a040ec1a979ec639.png" alt="image.png"></p> <h5 id="_6-进入-usr-local-nginx-sbin-目录执行启动命令"><a href="#_6-进入-usr-local-nginx-sbin-目录执行启动命令" class="header-anchor">#</a> 6. 进入 /usr/local/nginx/sbin 目录执行启动命令</h5> <p>就算下载在其他的位置，编译之后也会 放在/usr/local/nginx/...下面</p> <p>./nginx</p> <h5 id="_7-查看是否启动成功"><a href="#_7-查看是否启动成功" class="header-anchor">#</a> 7. 查看是否启动成功</h5> <p>ps -ef | grep nginx
<img src="https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-52e17dcfbf8e47adbf95246e7c5830ac.png" alt="image.png"></p> <h2 id="_3-nginx常用命令"><a href="#_3-nginx常用命令" class="header-anchor">#</a> 3. Nginx常用命令</h2> <div class="language-java line-numbers-mode"><pre class="language-java"><code># 查看nginx版本信息
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@centos7601</span> sbin<span class="token punctuation">]</span># <span class="token punctuation">.</span>/nginx <span class="token operator">-</span>v 
nginx version<span class="token operator">:</span> nginx<span class="token operator">/</span><span class="token number">1.18</span><span class="token number">.0</span>
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@centos7601</span> sbin<span class="token punctuation">]</span># ps <span class="token operator">-</span>ef <span class="token operator">|</span>grep nginx
root      <span class="token number">62288</span>      <span class="token number">1</span>  <span class="token number">0</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">18</span> <span class="token operator">?</span>        <span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span> nginx<span class="token operator">:</span> master process <span class="token punctuation">.</span>/nginx
nobody    <span class="token number">62290</span>  <span class="token number">62288</span>  <span class="token number">0</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">18</span> <span class="token operator">?</span>        <span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span> nginx<span class="token operator">:</span> worker process
root      <span class="token number">62325</span> <span class="token number">127532</span>  <span class="token number">0</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">18</span> pts<span class="token operator">/</span><span class="token number">3</span>    <span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span> grep <span class="token operator">--</span>color<span class="token operator">=</span>auto nginx
# 关闭nginx
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@centos7601</span> sbin<span class="token punctuation">]</span># <span class="token punctuation">.</span>/nginx <span class="token operator">-</span>s stop
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@centos7601</span> sbin<span class="token punctuation">]</span># ps <span class="token operator">-</span>ef <span class="token operator">|</span>grep nginx
root      <span class="token number">62346</span> <span class="token number">127532</span>  <span class="token number">0</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">18</span> pts<span class="token operator">/</span><span class="token number">3</span>    <span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span> grep <span class="token operator">--</span>color<span class="token operator">=</span>auto nginx
# 重新加载nginx，前提是nginx已启动
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@centos7601</span> sbin<span class="token punctuation">]</span># <span class="token punctuation">.</span>/nginx <span class="token operator">-</span>s reload
nginx<span class="token operator">:</span> <span class="token punctuation">[</span>error<span class="token punctuation">]</span> <span class="token keyword">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token string">&quot;/usr/local/nginx/logs/nginx.pid&quot;</span> failed <span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">:</span> <span class="token class-name">No</span> such file or directory<span class="token punctuation">)</span>
# 启动nginx
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@centos7601</span> sbin<span class="token punctuation">]</span># <span class="token punctuation">.</span>/nginx 
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@centos7601</span> sbin<span class="token punctuation">]</span># ps <span class="token operator">-</span>ef <span class="token operator">|</span>grep nginx
root      <span class="token number">62428</span>      <span class="token number">1</span>  <span class="token number">0</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">19</span> <span class="token operator">?</span>        <span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span> nginx<span class="token operator">:</span> master process <span class="token punctuation">.</span>/nginx
nobody    <span class="token number">62430</span>  <span class="token number">62428</span>  <span class="token number">0</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">19</span> <span class="token operator">?</span>        <span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span> nginx<span class="token operator">:</span> worker process
root      <span class="token number">62442</span> <span class="token number">127532</span>  <span class="token number">0</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">19</span> pts<span class="token operator">/</span><span class="token number">3</span>    <span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span> grep <span class="token operator">--</span>color<span class="token operator">=</span>auto nginx
# 重新加载nginx，前提是nginx已启动
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@centos7601</span> sbin<span class="token punctuation">]</span># <span class="token punctuation">.</span>/nginx <span class="token operator">-</span>s reload
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@centos7601</span> sbin<span class="token punctuation">]</span># ps <span class="token operator">-</span>ef <span class="token operator">|</span>grep nginx
root      <span class="token number">62428</span>      <span class="token number">1</span>  <span class="token number">0</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">19</span> <span class="token operator">?</span>        <span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span> nginx<span class="token operator">:</span> master process <span class="token punctuation">.</span>/nginx
nobody    <span class="token number">62453</span>  <span class="token number">62428</span>  <span class="token number">0</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">19</span> <span class="token operator">?</span>        <span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span> nginx<span class="token operator">:</span> worker process
root      <span class="token number">62465</span> <span class="token number">127532</span>  <span class="token number">0</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">19</span> pts<span class="token operator">/</span><span class="token number">3</span>    <span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span> grep <span class="token operator">--</span>color<span class="token operator">=</span>auto nginx

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h2 id="_4-nginx配置文件"><a href="#_4-nginx配置文件" class="header-anchor">#</a> 4. Nginx配置文件</h2> <p>配置文件的位置：/usr/local/nginx/conf/nginx.conf</p> <p>nginx.conf分为三个模块：全局块、events块、http块</p> <h4 id="_4-1-全局块"><a href="#_4-1-全局块" class="header-anchor">#</a> 4.1 全局块</h4> <p>全局块：从配置文件开始到 events 块之间的内容，主要会设置一些影响 Nginx 服务器整体运行的配置指令，配置服务器整体运行的配置指令。</p> <p>主要包括：</p> <p>1、配置运行 Nginx 服务器的用户（组）、
2、允许生成的 worker process 数，
3、进程 PID 存放路径、
4、日志存放路径和类型
5、配置文件的引入
6、…</p> <h4 id="_4-2-events块"><a href="#_4-2-events块" class="header-anchor">#</a> 4.2 events块</h4> <p>events 块涉及的指令主要影响 Nginx 服务器与用户的网络连接，常用的设置包括是否开启对多 work process 下的网络连接进行序列化，是否允许同时接收多个网络连接，选取哪种事件驱动模型来处理连接请求，每个 work process 可以同时支持的最大连接数等。</p> <h4 id="_4-3-http块"><a href="#_4-3-http块" class="header-anchor">#</a> 4.3 http块</h4> <p>http块是 Nginx 服务器配置中最频繁的<strong>部分，代理、缓存和日志</strong>定义等绝大多数功能和第三方模块的配置都在这里。</p> <p>需要注意的是，http 块也可以包括:</p> <p>● http 全局块
● 多个server 块</p> <h5 id="_4-3-1-http-全局块"><a href="#_4-3-1-http-全局块" class="header-anchor">#</a> 4.3.1 http 全局块</h5> <p>http 全局块配置的指令包括文件引入、 MIME-TYPE 定义、日志自定义、连接超时时间、单链接请求数上限等</p> <h5 id="_4-3-2-server-块"><a href="#_4-3-2-server-块" class="header-anchor">#</a> 4.3.2 server 块</h5> <p>这块和虚拟主机有密切关系，虚拟主机从用户角度看，和单一独立的硬件主机是完全一样的，该技术的产生是为了节省互联网服务器硬件成本。</p> <p>每个 http 块可以包括多个 server 块，而每个 server 块就相当于一个<strong>虚拟主机</strong>。</p> <p>而每个 server 块也分为：</p> <p>● 全局 server 块
● 多个 locaton 块</p> <h6 id="_4-3-2-1-全局-server-块"><a href="#_4-3-2-1-全局-server-块" class="header-anchor">#</a> 4.3.2.1 全局 server 块</h6> <p>最常见的配置是本虚拟机主机的监听配置和<strong>本虚拟主机的名称或 IP 配置</strong>。</p> <h6 id="_4-3-2-2-location-块"><a href="#_4-3-2-2-location-块" class="header-anchor">#</a> 4.3.2.2 location 块</h6> <p>一个 server 块可以配置多个 location 块。</p> <p>这块的主要作用是基于 Nginx 服务器接收到的<strong>请求字符串</strong>（例如 server_name/uri-string），对虚拟主机名称（也可以是 IP 别名）之外的字符串（例如： /uri-string）进行匹配，对特定的请求进行处理。</p> <p>4.4 配置文件的内容解析</p> <p>更多内容可参考：</p> <p>https://blog.csdn.net/wangbin_0729/article/details/82109693
https://www.cnblogs.com/hunttown/p/5759959.html</p> <p><img src="https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-a29f1df916d046e49973a4504266756d.png" alt="image.png"></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>#指定了<span class="token class-name">Nginx</span>要开启的进程数。
#每个<span class="token class-name">Nginx</span>进程平均耗费<span class="token number">10</span>M<span class="token operator">~</span><span class="token number">12</span>M内存。建议指定和CPU的数量一致即可。
worker_processes <span class="token number">8</span><span class="token punctuation">;</span>
 
#定义全局错误日志文件。日志输出级别有debug、info、notice、warn、error、crit可供选择
#其中，debug输出日志最为最详细，而crit输出日志最少。
error_log <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>logs<span class="token operator">/</span>error<span class="token punctuation">.</span>log info<span class="token punctuation">;</span>

#指定进程pid的存储文件位置
pid <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>logs<span class="token operator">/</span>nginx<span class="token punctuation">.</span>pid<span class="token punctuation">;</span>

#指定进程可以打开的最大描述符：数目
#工作模式与连接数上限
#这个指令是指当一个nginx进程打开的最多文件描述符数目，理论值应该是最多打开文件数（ulimit <span class="token operator">-</span>n）与nginx进程数相除，但是nginx分配请求并不是那么均匀，所以最好与ulimit <span class="token operator">-</span>n 的值保持一致。
#现在在linux <span class="token number">2.6</span>内核下开启文件打开数为<span class="token number">65535</span>，worker_rlimit_nofile就相应应该填写<span class="token number">65535</span>。
#这是因为nginx调度时分配请求到进程并不是那么的均衡，所以假如填写<span class="token number">10240</span>，总并发量达到<span class="token number">3</span><span class="token operator">-</span><span class="token number">4</span>万时就有进程可能超过<span class="token number">10240</span>了，这时会返回<span class="token number">502</span>错误。
worker_rlimit_nofile <span class="token number">65535</span><span class="token punctuation">;</span>

# events事件指令是设定<span class="token class-name">Nginx</span>的工作模式及连接数上限：
events
<span class="token punctuation">{</span>
    #events事件指令是设定<span class="token class-name">Nginx</span>的工作模式及连接数上限：
    #use是个事件模块指令，用来指定<span class="token class-name">Nginx</span>的工作模式。
    #<span class="token class-name">Nginx</span>支持的工作模式有select、poll、kqueue、epoll、rtsig和<span class="token operator">/</span>dev<span class="token operator">/</span>poll。
    #其中select和poll都是标准的工作模式，kqueue和epoll是高效的工作模式，不同的是epoll用在<span class="token class-name">Linux</span>平台上，而kqueue用在BSD系统中。
    #对于<span class="token class-name">Linux</span>系统，epoll工作模式是首选。
    use epoll<span class="token punctuation">;</span>

    #worker_connections也是个事件模块指令，用于定义<span class="token class-name">Nginx</span>每个进程的最大连接数，默认是<span class="token number">1024</span>。
    #最大客户端连接数由worker_processes和worker_connections决定，即<span class="token class-name">Max_clients</span><span class="token operator">=</span>worker_processes<span class="token operator">*</span>worker_connections。
    #在作为反向代理时，max_clients变为：max_clients <span class="token operator">=</span> worker_processes <span class="token operator">*</span> worker_connections<span class="token operator">/</span><span class="token number">4</span>。
	#进程的最大连接数受<span class="token class-name">Linux</span>系统进程的最大打开文件数限制，在执行操作系统命令“ulimit <span class="token operator">-</span>n <span class="token number">65536</span>”后worker_connections的设置才能生效
    worker_connections <span class="token number">1024</span><span class="token punctuation">;</span>

    #keepalive超时时间。
    keepalive_timeout <span class="token number">60</span><span class="token punctuation">;</span>

    #客户端请求头部的缓冲区大小。
    #这个可以根据你的系统分页大小来设置，一般一个请求头的大小不会超过<span class="token number">1</span>k，不过由于一般系统分页都要大于<span class="token number">1</span>k，所以这里设置为分页大小。
    #分页大小可以用命令getconf PAGESIZE 取得。
    #<span class="token punctuation">[</span>root<span class="token annotation punctuation">@web001</span> <span class="token operator">~</span><span class="token punctuation">]</span># getconf PAGESIZE
    #<span class="token number">4096</span>
    #但也有client_header_buffer_size超过<span class="token number">4</span>k的情况，但是client_header_buffer_size该值必须设置为“系统分页大小”的整倍数。
    client_header_buffer_size <span class="token number">4</span>k<span class="token punctuation">;</span>

    #这个将为打开文件指定缓存，默认是没有启用的，max指定缓存数量，建议和打开文件数一致，inactive是指经过多长时间文件没被请求后删除缓存。
    open_file_cache max<span class="token operator">=</span><span class="token number">65535</span> inactive<span class="token operator">=</span><span class="token number">60</span>s<span class="token punctuation">;</span>

    #这个是指多长时间检查一次缓存的有效信息。
    #语法<span class="token operator">:</span>open_file_cache_valid time 默认值<span class="token operator">:</span>open_file_cache_valid <span class="token number">60</span> 使用字段<span class="token operator">:</span>http<span class="token punctuation">,</span> server<span class="token punctuation">,</span> location 这个指令指定了何时需要检查open_file_cache中缓存项目的有效信息<span class="token punctuation">.</span>
    open_file_cache_valid <span class="token number">80</span>s<span class="token punctuation">;</span>

    #open_file_cache指令中的inactive参数时间内文件的最少使用次数，如果超过这个数字，文件描述符一直是在缓存中打开的，如上例，如果有一个文件在inactive时间内一次没被使用，它将被移除。
    #语法<span class="token operator">:</span>open_file_cache_min_uses number 默认值<span class="token operator">:</span>open_file_cache_min_uses <span class="token number">1</span> 使用字段<span class="token operator">:</span>http<span class="token punctuation">,</span> server<span class="token punctuation">,</span> location  这个指令指定了在open_file_cache指令无效的参数中一定的时间范围内可以使用的最小文件数<span class="token punctuation">,</span>如果使用更大的值<span class="token punctuation">,</span>文件描述符在cache中总是打开状态<span class="token punctuation">.</span>
    open_file_cache_min_uses <span class="token number">1</span><span class="token punctuation">;</span>
    
    #语法<span class="token operator">:</span>open_file_cache_errors on <span class="token operator">|</span> off 默认值<span class="token operator">:</span>open_file_cache_errors off 使用字段<span class="token operator">:</span>http<span class="token punctuation">,</span> server<span class="token punctuation">,</span> location 这个指令指定是否在搜索一个文件是记录cache错误<span class="token punctuation">.</span>
    open_file_cache_errors on<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
 
 
 
#设定http服务器，利用它的反向代理功能提供负载均衡支持
http
<span class="token punctuation">{</span>
	#实现对配置文件所包含的文件的设定，可以减少主配置文件的复杂度。类似于<span class="token class-name">Apache</span>中的include方法。
    #文件扩展名与文件类型映射表
    include mime<span class="token punctuation">.</span>types<span class="token punctuation">;</span>

    #默认文件类型
    default_type application<span class="token operator">/</span>octet<span class="token operator">-</span>stream<span class="token punctuation">;</span>

    #默认编码
    #charset utf<span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">;</span>

    #服务器名字的hash表大小
    #保存服务器名字的hash表是由指令server_names_hash_max_size 和server_names_hash_bucket_size所控制的。参数hash bucket size总是等于hash表的大小，并且是一路处理器缓存大小的倍数。在减少了在内存中的存取次数后，使在处理器中加速查找hash表键值成为可能。如果hash bucket size等于一路处理器缓存的大小，那么在查找键的时候，最坏的情况下在内存中查找的次数为<span class="token number">2</span>。第一次是确定存储单元的地址，第二次是在存储单元中查找键 值。因此，如果<span class="token class-name">Nginx</span>给出需要增大hash max size 或 hash bucket size的提示，那么首要的是增大前一个参数的大小<span class="token punctuation">.</span>
    server_names_hash_bucket_size <span class="token number">128</span><span class="token punctuation">;</span>

    #客户端请求头部的缓冲区大小。这个可以根据你的系统分页大小来设置，一般一个请求的头部大小不会超过<span class="token number">1</span>k，不过由于一般系统分页都要大于<span class="token number">1</span>k，所以这里设置为分页大小。分页大小可以用命令getconf PAGESIZE取得。
    client_header_buffer_size <span class="token number">32</span>k<span class="token punctuation">;</span>

    #客户请求头缓冲大小。nginx默认会用client_header_buffer_size这个buffer来读取header值，如果header过大，它会使用large_client_header_buffers来读取。
    large_client_header_buffers <span class="token number">4</span> <span class="token number">64</span>k<span class="token punctuation">;</span>

    #设定通过nginx上传文件的大小
    client_max_body_size <span class="token number">8</span>m<span class="token punctuation">;</span>

    #开启高效文件传输模式，sendfile指令指定nginx是否调用sendfile函数来输出文件，对于普通应用设为 on，如果用来进行下载等应用磁盘IO重负载应用，可设置为off，以平衡磁盘与网络<span class="token class-name">I</span><span class="token operator">/</span><span class="token class-name">O</span>处理速度，降低系统的负载。注意：如果图片显示不正常把这个改成off。
    #sendfile指令指定 nginx 是否调用sendfile 函数（zero copy 方式）来输出文件，对于普通应用，必须设为on。如果用来进行下载等应用磁盘IO重负载应用，可设置为off，以平衡磁盘与网络IO处理速度，降低系统uptime。
    sendfile on<span class="token punctuation">;</span>

    #开启目录列表访问，合适下载服务器，默认关闭。
    autoindex on<span class="token punctuation">;</span>

    #此选项允许或禁止使用socke的TCP_CORK的选项，此选项仅在使用sendfile的时候使用
    tcp_nopush on<span class="token punctuation">;</span>
     
    tcp_nodelay on<span class="token punctuation">;</span>

    #长连接超时时间，单位是秒
    keepalive_timeout <span class="token number">120</span><span class="token punctuation">;</span>

    #<span class="token class-name">FastCGI</span>相关参数是为了改善网站的性能：减少资源占用，提高访问速度。下面参数看字面意思都能理解。
    fastcgi_connect_timeout <span class="token number">300</span><span class="token punctuation">;</span>
    fastcgi_send_timeout <span class="token number">300</span><span class="token punctuation">;</span>
    fastcgi_read_timeout <span class="token number">300</span><span class="token punctuation">;</span>
    fastcgi_buffer_size <span class="token number">64</span>k<span class="token punctuation">;</span>
    fastcgi_buffers <span class="token number">4</span> <span class="token number">64</span>k<span class="token punctuation">;</span>
    fastcgi_busy_buffers_size <span class="token number">128</span>k<span class="token punctuation">;</span>
    fastcgi_temp_file_write_size <span class="token number">128</span>k<span class="token punctuation">;</span>

    #gzip模块设置
    gzip on<span class="token punctuation">;</span> #开启gzip压缩输出
    gzip_min_length <span class="token number">1</span>k<span class="token punctuation">;</span>    #最小压缩文件大小
    gzip_buffers <span class="token number">4</span> <span class="token number">16</span>k<span class="token punctuation">;</span>    #压缩缓冲区
    gzip_http_version <span class="token number">1.0</span><span class="token punctuation">;</span>    #压缩版本（默认<span class="token number">1.1</span>，前端如果是squid2<span class="token punctuation">.</span><span class="token number">5</span>请使用<span class="token number">1.0</span>）
    gzip_comp_level <span class="token number">2</span><span class="token punctuation">;</span>    #压缩等级
    gzip_types text<span class="token operator">/</span>plain application<span class="token operator">/</span>x<span class="token operator">-</span>javascript text<span class="token operator">/</span>css application<span class="token operator">/</span>xml<span class="token punctuation">;</span>    #压缩类型，默认就已经包含textml，所以下面就不用再写了，写上去也不会有问题，但是会有一个warn。
    gzip_vary on<span class="token punctuation">;</span>

    #开启限制IP连接数的时候需要使用
    #limit_zone crawler $binary_remote_addr <span class="token number">10</span>m<span class="token punctuation">;</span>


    #负载均衡配置
    upstream piao<span class="token punctuation">.</span>jd<span class="token punctuation">.</span>com <span class="token punctuation">{</span>
     
        #upstream的负载均衡，weight是权重，可以根据机器配置定义权重。weigth参数表示权值，权值越高被分配到的几率越大。
        server <span class="token number">192.168</span><span class="token number">.80</span><span class="token number">.121</span><span class="token operator">:</span><span class="token number">80</span> weight<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span>
        server <span class="token number">192.168</span><span class="token number">.80</span><span class="token number">.122</span><span class="token operator">:</span><span class="token number">80</span> weight<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>
        server <span class="token number">192.168</span><span class="token number">.80</span><span class="token number">.123</span><span class="token operator">:</span><span class="token number">80</span> weight<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span>

        #nginx的upstream目前支持<span class="token number">4</span>种方式的分配
        #<span class="token number">1</span>、轮询（默认）
        #每个请求按时间顺序逐一分配到不同的后端服务器，如果后端服务器down掉，能自动剔除。
        #<span class="token number">2</span>、weight
        #指定轮询几率，weight和访问比率成正比，用于后端服务器性能不均的情况。
        #例如：
        #upstream bakend <span class="token punctuation">{</span>
        #    server <span class="token number">192.168</span><span class="token number">.0</span><span class="token number">.14</span> weight<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span>
        #    server <span class="token number">192.168</span><span class="token number">.0</span><span class="token number">.15</span> weight<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span>
        #<span class="token punctuation">}</span>
        #<span class="token number">2</span>、ip_hash
        #每个请求按访问ip的hash结果分配，这样每个访客固定访问一个后端服务器，可以解决session的问题。
        #例如：
        #upstream bakend <span class="token punctuation">{</span>
        #    ip_hash<span class="token punctuation">;</span>
        #    server <span class="token number">192.168</span><span class="token number">.0</span><span class="token number">.14</span><span class="token operator">:</span><span class="token number">88</span><span class="token punctuation">;</span>
        #    server <span class="token number">192.168</span><span class="token number">.0</span><span class="token number">.15</span><span class="token operator">:</span><span class="token number">80</span><span class="token punctuation">;</span>
        #<span class="token punctuation">}</span>
        #<span class="token number">3</span>、fair（第三方）
        #按后端服务器的响应时间来分配请求，响应时间短的优先分配。
        #upstream backend <span class="token punctuation">{</span>
        #    server server1<span class="token punctuation">;</span>
        #    server server2<span class="token punctuation">;</span>
        #    fair<span class="token punctuation">;</span>
        #<span class="token punctuation">}</span>
        #<span class="token number">4</span>、url_hash（第三方）
        #按访问url的hash结果来分配请求，使每个url定向到同一个后端服务器，后端服务器为缓存时比较有效。
        #例：在upstream中加入hash语句，server语句中不能写入weight等其他的参数，hash_method是使用的hash算法
        #upstream backend <span class="token punctuation">{</span>
        #    server squid1<span class="token operator">:</span><span class="token number">3128</span><span class="token punctuation">;</span>
        #    server squid2<span class="token operator">:</span><span class="token number">3128</span><span class="token punctuation">;</span>
        #    hash $request_uri<span class="token punctuation">;</span>
        #    hash_method crc32<span class="token punctuation">;</span>
        #<span class="token punctuation">}</span>

        #tips<span class="token operator">:</span>
        #upstream bakend<span class="token punctuation">{</span>#定义负载均衡设备的<span class="token class-name">Ip</span>及设备状态<span class="token punctuation">}</span><span class="token punctuation">{</span>
        #    ip_hash<span class="token punctuation">;</span>
        #    server <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">9090</span> down<span class="token punctuation">;</span>
        #    server <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">8080</span> weight<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>
        #    server <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">6060</span><span class="token punctuation">;</span>
        #    server <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">7070</span> backup<span class="token punctuation">;</span>
        #<span class="token punctuation">}</span>
        #在需要使用负载均衡的server中增加 proxy_pass http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>bakend<span class="token operator">/</span><span class="token punctuation">;</span>

        #每个设备的状态设置为<span class="token operator">:</span>
        #<span class="token number">1.d</span>own表示单前的server暂时不参与负载
        #<span class="token number">2.</span>weight为weight越大，负载的权重就越大。
        #<span class="token number">3.</span>max_fails：允许请求失败的次数默认为<span class="token number">1.</span>当超过最大次数时，返回proxy_next_upstream模块定义的错误
        #<span class="token number">4.f</span>ail_timeout<span class="token operator">:</span>max_fails次失败后，暂停的时间。
        #<span class="token number">5.</span>backup： 其它所有的非backup机器down或者忙的时候，请求backup机器。所以这台机器压力会最轻。

        #nginx支持同时设置多组的负载均衡，用来给不用的server来使用。
        #client_body_in_file_only设置为<span class="token class-name">On</span> 可以讲client post过来的数据记录到文件中用来做debug
        #client_body_temp_path设置记录文件的目录 可以设置最多<span class="token number">3</span>层目录
        #location对URL进行匹配<span class="token punctuation">.</span>可以进行重定向或者进行新的代理 负载均衡
    <span class="token punctuation">}</span>
     
     
     
    #虚拟主机的配置
    server
    <span class="token punctuation">{</span>
        #监听端口
        listen <span class="token number">80</span><span class="token punctuation">;</span>

        #域名可以有多个，用空格隔开
        server_name www<span class="token punctuation">.</span>jd<span class="token punctuation">.</span>com jd<span class="token punctuation">.</span>com<span class="token punctuation">;</span>
        index index<span class="token punctuation">.</span>html index<span class="token punctuation">.</span>htm index<span class="token punctuation">.</span>php<span class="token punctuation">;</span>
        root <span class="token operator">/</span>data<span class="token operator">/</span>www<span class="token operator">/</span>jd<span class="token punctuation">;</span>

        #对<span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>进行负载均衡
        location <span class="token operator">~</span> <span class="token punctuation">.</span>*<span class="token punctuation">.</span><span class="token punctuation">(</span>php<span class="token operator">|</span>php5<span class="token punctuation">)</span><span class="token operator">?</span>$
        <span class="token punctuation">{</span>
            fastcgi_pass <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">9000</span><span class="token punctuation">;</span>
            fastcgi_index index<span class="token punctuation">.</span>php<span class="token punctuation">;</span>
            include fastcgi<span class="token punctuation">.</span>conf<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
         
        #图片缓存时间设置
        location <span class="token operator">~</span> <span class="token punctuation">.</span>*<span class="token punctuation">.</span><span class="token punctuation">(</span>gif<span class="token operator">|</span>jpg<span class="token operator">|</span>jpeg<span class="token operator">|</span>png<span class="token operator">|</span>bmp<span class="token operator">|</span>swf<span class="token punctuation">)</span>$
        <span class="token punctuation">{</span>
            expires <span class="token number">10d</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
         
        #JS和CSS缓存时间设置
        location <span class="token operator">~</span> <span class="token punctuation">.</span>*<span class="token punctuation">.</span><span class="token punctuation">(</span>js<span class="token operator">|</span>css<span class="token punctuation">)</span><span class="token operator">?</span>$
        <span class="token punctuation">{</span>
            expires <span class="token number">1</span>h<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
         
        #日志格式设定
        #$remote_addr与$http_x_forwarded_for用以记录客户端的ip地址；
        #$remote_user：用来记录客户端用户名称；
        #$time_local： 用来记录访问时间与时区；
        #$request： 用来记录请求的url与http协议；
        #$status： 用来记录请求状态；成功是<span class="token number">200</span>，
        #$body_bytes_sent ：记录发送给客户端文件主体内容大小；
        #$http_referer：用来记录从那个页面链接访问过来的；
        #$http_user_agent：记录客户浏览器的相关信息；
        #通常web服务器放在反向代理的后面，这样就不能获取到客户的IP地址了，通过$remote_add拿到的IP地址是反向代理服务器的iP地址。反向代理服务器在转发请求的http头信息中，可以增加x_forwarded_for信息，用以记录原有客户端的IP地址和原来客户端的请求的服务器地址。
        log_format access '$remote_addr <span class="token operator">-</span> $remote_user <span class="token punctuation">[</span>$time_local<span class="token punctuation">]</span> <span class="token string">&quot;$request&quot;</span> '
        '$status $body_bytes_sent <span class="token string">&quot;$http_referer&quot;</span> '
        '<span class="token string">&quot;$http_user_agent&quot;</span> $http_x_forwarded_for'<span class="token punctuation">;</span>
         
        #定义本虚拟主机的访问日志
        access_log  <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>logs<span class="token operator">/</span>host<span class="token punctuation">.</span>access<span class="token punctuation">.</span>log  main<span class="token punctuation">;</span>
        access_log  <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>logs<span class="token operator">/</span>host<span class="token punctuation">.</span>access<span class="token punctuation">.</span><span class="token number">404.l</span>og  log404<span class="token punctuation">;</span>
         
        #对 <span class="token string">&quot;/&quot;</span> 启用反向代理
        location <span class="token operator">/</span> <span class="token punctuation">{</span>
            proxy_pass http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">88</span><span class="token punctuation">;</span>
            proxy_redirect off<span class="token punctuation">;</span>
            proxy_set_header <span class="token class-name">X</span><span class="token operator">-</span><span class="token class-name">Real</span><span class="token operator">-</span>IP $remote_addr<span class="token punctuation">;</span>
             
            #后端的<span class="token class-name">Web</span>服务器可以通过<span class="token class-name">X</span><span class="token operator">-</span><span class="token class-name">Forwarded</span><span class="token operator">-</span><span class="token class-name">For</span>获取用户真实IP
            proxy_set_header <span class="token class-name">X</span><span class="token operator">-</span><span class="token class-name">Forwarded</span><span class="token operator">-</span><span class="token class-name">For</span> $proxy_add_x_forwarded_for<span class="token punctuation">;</span>
             
            #以下是一些反向代理的配置，可选。
            proxy_set_header <span class="token class-name">Host</span> $host<span class="token punctuation">;</span>

            #允许客户端请求的最大单文件字节数
            client_max_body_size <span class="token number">10</span>m<span class="token punctuation">;</span>

            #缓冲区代理缓冲用户端请求的最大字节数，
            #如果把它设置为比较大的数值，例如<span class="token number">256</span>k，那么，无论使用firefox还是IE浏览器，来提交任意小于<span class="token number">256</span>k的图片，都很正常。如果注释该指令，使用默认的client_body_buffer_size设置，也就是操作系统页面大小的两倍，<span class="token number">8</span>k或者<span class="token number">16</span>k，问题就出现了。
            #无论使用firefox4<span class="token punctuation">.</span><span class="token number">0</span>还是IE8<span class="token punctuation">.</span><span class="token number">0</span>，提交一个比较大，<span class="token number">200</span>k左右的图片，都返回<span class="token number">500</span> <span class="token class-name">Internal</span> <span class="token class-name">Server</span> <span class="token class-name">Error</span>错误
            client_body_buffer_size <span class="token number">128</span>k<span class="token punctuation">;</span>

            #表示使nginx阻止HTTP应答代码为<span class="token number">400</span>或者更高的应答。
            proxy_intercept_errors on<span class="token punctuation">;</span>

            #后端服务器连接的超时时间_发起握手等候响应超时时间
            #nginx跟后端服务器连接超时时间<span class="token punctuation">(</span>代理连接超时<span class="token punctuation">)</span>
            proxy_connect_timeout <span class="token number">90</span><span class="token punctuation">;</span>

            #后端服务器数据回传时间<span class="token punctuation">(</span>代理发送超时<span class="token punctuation">)</span>
            #后端服务器数据回传时间_就是在规定时间之内后端服务器必须传完所有的数据
            proxy_send_timeout <span class="token number">90</span><span class="token punctuation">;</span>

            #连接成功后，后端服务器响应时间<span class="token punctuation">(</span>代理接收超时<span class="token punctuation">)</span>
            #连接成功后_等候后端服务器响应时间_其实已经进入后端的排队之中等候处理（也可以说是后端服务器处理请求的时间）
            proxy_read_timeout <span class="token number">90</span><span class="token punctuation">;</span>

            #设置代理服务器（nginx）保存用户头信息的缓冲区大小
            #设置从被代理服务器读取的第一部分应答的缓冲区大小，通常情况下这部分应答中包含一个小的应答头，默认情况下这个值的大小为指令proxy_buffers中指定的一个缓冲区的大小，不过可以将其设置为更小
            proxy_buffer_size <span class="token number">4</span>k<span class="token punctuation">;</span>

            #proxy_buffers缓冲区，网页平均在<span class="token number">32</span>k以下的设置
            #设置用于读取应答（来自被代理服务器）的缓冲区数目和大小，默认情况也为分页大小，根据操作系统的不同可能是<span class="token number">4</span>k或者<span class="token number">8</span>k
            proxy_buffers <span class="token number">4</span> <span class="token number">32</span>k<span class="token punctuation">;</span>

            #高负荷下缓冲大小（proxy_buffers<span class="token operator">*</span><span class="token number">2</span>）
            proxy_busy_buffers_size <span class="token number">64</span>k<span class="token punctuation">;</span>

            #设置在写入proxy_temp_path时数据的大小，预防一个工作进程在传递文件时阻塞太长
            #设定缓存文件夹大小，大于这个值，将从upstream服务器传
            proxy_temp_file_write_size <span class="token number">64</span>k<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
         
         
        #设定查看<span class="token class-name">Nginx</span>状态的地址
        location <span class="token operator">/</span><span class="token class-name">NginxStatus</span> <span class="token punctuation">{</span>
            stub_status on<span class="token punctuation">;</span>
            access_log on<span class="token punctuation">;</span>
            auth_basic <span class="token string">&quot;NginxStatus&quot;</span><span class="token punctuation">;</span>
            auth_basic_user_file confpasswd<span class="token punctuation">;</span>
            #htpasswd文件的内容可以用apache提供的htpasswd工具来产生。
        <span class="token punctuation">}</span>
         
        #本地动静分离反向代理配置
        #所有jsp的页面均交由tomcat或resin处理
        location <span class="token operator">~</span> <span class="token punctuation">.</span><span class="token punctuation">(</span>jsp<span class="token operator">|</span>jspx<span class="token operator">|</span><span class="token keyword">do</span><span class="token punctuation">)</span><span class="token operator">?</span>$ <span class="token punctuation">{</span>
            proxy_set_header <span class="token class-name">Host</span> $host<span class="token punctuation">;</span>
            proxy_set_header <span class="token class-name">X</span><span class="token operator">-</span><span class="token class-name">Real</span><span class="token operator">-</span>IP $remote_addr<span class="token punctuation">;</span>
            proxy_set_header <span class="token class-name">X</span><span class="token operator">-</span><span class="token class-name">Forwarded</span><span class="token operator">-</span><span class="token class-name">For</span> $proxy_add_x_forwarded_for<span class="token punctuation">;</span>
            proxy_pass http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">8080</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
         
        #所有静态文件由nginx直接读取不经过tomcat或resin
        location <span class="token operator">~</span> <span class="token punctuation">.</span>*<span class="token punctuation">.</span><span class="token punctuation">(</span>htm<span class="token operator">|</span>html<span class="token operator">|</span>gif<span class="token operator">|</span>jpg<span class="token operator">|</span>jpeg<span class="token operator">|</span>png<span class="token operator">|</span>bmp<span class="token operator">|</span>swf<span class="token operator">|</span>ioc<span class="token operator">|</span>rar<span class="token operator">|</span>zip<span class="token operator">|</span>txt<span class="token operator">|</span>flv<span class="token operator">|</span>mid<span class="token operator">|</span>doc<span class="token operator">|</span>ppt<span class="token operator">|</span>
        pdf<span class="token operator">|</span>xls<span class="token operator">|</span>mp3<span class="token operator">|</span>wma<span class="token punctuation">)</span>$
        <span class="token punctuation">{</span>
            expires <span class="token number">15d</span><span class="token punctuation">;</span> 
        <span class="token punctuation">}</span>
         
        location <span class="token operator">~</span> <span class="token punctuation">.</span>*<span class="token punctuation">.</span><span class="token punctuation">(</span>js<span class="token operator">|</span>css<span class="token punctuation">)</span><span class="token operator">?</span>$
        <span class="token punctuation">{</span>
            expires <span class="token number">1</span>h<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br><span class="line-number">288</span><br><span class="line-number">289</span><br><span class="line-number">290</span><br><span class="line-number">291</span><br><span class="line-number">292</span><br><span class="line-number">293</span><br><span class="line-number">294</span><br><span class="line-number">295</span><br><span class="line-number">296</span><br><span class="line-number">297</span><br><span class="line-number">298</span><br><span class="line-number">299</span><br><span class="line-number">300</span><br><span class="line-number">301</span><br><span class="line-number">302</span><br><span class="line-number">303</span><br><span class="line-number">304</span><br><span class="line-number">305</span><br><span class="line-number">306</span><br><span class="line-number">307</span><br><span class="line-number">308</span><br><span class="line-number">309</span><br><span class="line-number">310</span><br><span class="line-number">311</span><br><span class="line-number">312</span><br><span class="line-number">313</span><br><span class="line-number">314</span><br><span class="line-number">315</span><br><span class="line-number">316</span><br><span class="line-number">317</span><br><span class="line-number">318</span><br><span class="line-number">319</span><br><span class="line-number">320</span><br><span class="line-number">321</span><br><span class="line-number">322</span><br><span class="line-number">323</span><br><span class="line-number">324</span><br><span class="line-number">325</span><br><span class="line-number">326</span><br></div></div><h2 id="_5-配置反向代理"><a href="#_5-配置反向代理" class="header-anchor">#</a> 5. 配置反向代理</h2> <h3 id="案例一"><a href="#案例一" class="header-anchor">#</a> 案例一：</h3> <p>案例效果：打开浏览器，在浏览器地址栏输入地址 www.123.com ，跳转到 liunx 系统 tomcat 主页面中</p> <p>前面我们已经了解了反向代理是代理后端服务器的，我们以一张图再回顾一下，这张图也是此案例配置的示例图！
<img src="https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-338cc03a3fb342dc99cbf3979e84d154.png" alt="image.png">
从图中我们可以看出，我们还需要配置tomcat，安装tomcat可参考：https://www.yuque.com/bithachi/study/ko2vq0 的第5个内容。</p> <p>并且Nginx开放80端口，可参考上面的安装Nginx部分配置端口。</p> <p>我们将图上所述的配置好之后，启动nginx测试，windows浏览器访问www.123.com，Nginx反向代理服务器会将请求转发到tomcat默认测试的127.0.0.1：8080页面。</p> <p><img src="https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-bd1b43adc5ee4690be69a48662a83bfb.png" alt="image.png"></p> <p><img src="https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-558239dd026544d9a456a9d4ec279282.png" alt="image.png"></p> <h4 id="在linux中安装-tomcat"><a href="#在linux中安装-tomcat" class="header-anchor">#</a> 在Linux中安装 tomcat</h4> <p>效果图：
<img src="https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-ff7126f2bbe7485291886b76a4f114a1.png" alt="image.png"></p> <h5 id="一、首先到官方下载tomcat服务"><a href="#一、首先到官方下载tomcat服务" class="header-anchor">#</a> 一、首先到官方下载tomcat服务</h5> <h5 id="二、将tomcat上传至linux服务器中"><a href="#二、将tomcat上传至linux服务器中" class="header-anchor">#</a> 二、将tomcat上传至linux服务器中</h5> <p><img src="https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-6778164c84e849cbac540390389a149c.png" alt="image.png"></p> <p>2.解压：tar zxvf apache-tomcat-7.0.67.tar.gz</p> <h5 id="三、配置环境编辑-etc-profile文件"><a href="#三、配置环境编辑-etc-profile文件" class="header-anchor">#</a> 三、配置环境编辑/etc/profile文件</h5> <div class="language-java line-numbers-mode"><pre class="language-java"><code>JAVA_HOME<span class="token operator">=</span><span class="token operator">/</span>rommr<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">6.0_45</span>
PATH<span class="token operator">=</span>$JAVA_HOME<span class="token operator">/</span>bin<span class="token operator">:</span>$<span class="token class-name">PATH</span>
CLASSPATH<span class="token operator">=</span><span class="token punctuation">.</span><span class="token punctuation">:</span>$JAVA_HOME<span class="token operator">/</span>lib<span class="token operator">/</span>dt<span class="token punctuation">.</span>jar<span class="token operator">:</span>$JAVA_HOME<span class="token operator">/</span>lib<span class="token operator">/</span>tools<span class="token punctuation">.</span>jar
CATALINA_HOME<span class="token operator">=</span><span class="token operator">/</span>rommr<span class="token operator">/</span>tomcat7 #其他的是jdk配置 重要的就是这点
export JAVA_HOME CATALINA_HOME #这点ok
export PATH
export <span class="token class-name">CLASSPATH</span>
JAVA_HOME<span class="token operator">=</span><span class="token operator">/</span>rommr<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">6.0_45</span>
PATH<span class="token operator">=</span>$JAVA_HOME<span class="token operator">/</span>bin<span class="token operator">:</span>$<span class="token class-name">PATH</span>
CLASSPATH<span class="token operator">=</span><span class="token punctuation">.</span><span class="token punctuation">:</span>$JAVA_HOME<span class="token operator">/</span>lib<span class="token operator">/</span>dt<span class="token punctuation">.</span>jar<span class="token operator">:</span>$JAVA_HOME<span class="token operator">/</span>lib<span class="token operator">/</span>tools<span class="token punctuation">.</span>jar
CATALINA_HOME<span class="token operator">=</span><span class="token operator">/</span>rommr<span class="token operator">/</span>tomcat7 #其他的是jdk配置 重要的就是这点
export JAVA_HOME CATALINA_HOME #这点ok
export PATH
export CLASSPATH

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>以上配置完后执行： source /etc/profile 配置文件生效</p> <h5 id="四、启动tomcat-进入tomcat-bin目录"><a href="#四、启动tomcat-进入tomcat-bin目录" class="header-anchor">#</a> 四、启动tomcat 进入tomcat bin目录</h5> <p>./startup.sh启动 ./shutdown.sh关闭命令
<img src="https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-a9ab389faa1745efa316805779d9904f.png" alt="image.png">
启动命令之后浏览器上输入：http:\localhost:8080\ 如果在外部访问需要写上ip地址http:\192.168.38.128:8080\ 可以看到tomcat信息</p> <h5 id="五-开启防火墙8080端口"><a href="#五-开启防火墙8080端口" class="header-anchor">#</a> 五 开启防火墙8080端口</h5> <p><img src="https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-98f76dd718a641d9bf71f6f1a749c40e.png" alt="image.png"> <img src="https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-7e1588b077aa459ea739fad7ab70b604.png" alt="image.png"></p> <h4 id="配置nginx配置文件"><a href="#配置nginx配置文件" class="header-anchor">#</a> 配置nginx配置文件</h4> <p>在/usr/local/nginx/conf/nginx.conf
<img src="https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-0e73868074be43868e526f802b45c71a.png" alt="image.png"></p> <p><img src="https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-e87ac1b564294d90a7d8d063318e0806.png" alt="image.png"></p> <h3 id="_5-2-案例二"><a href="#_5-2-案例二" class="header-anchor">#</a> 5.2 案例二</h3> <p>实现效果：使用 nginx 反向代理，根据访问的路径跳转到不同端口的服务中nginx 监听端口为 9001
访问 http://192.168.14.128:9001/edu/ 直接跳转到 127.0.0.1:8080
访问 http:// 192.168.14.128:9001/vod/ 直接跳转到 127.0.0.1:8081</p> <p>配置步骤：
（1 ）准备两个 tomcat 服务器，一个 8080 端口，一个 8081 端口
（2 ）创建文件夹edu和vod和测试页面a.html
（3 ）开放对外访问的端口号 9001 8080 8081
(4 ）修改nginx.conf
(5）测试访问
<img src="https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-f18045a2e54b44e0b6346ec5039e5002.png" alt="image.png">
nginx.conf中http块中的location块 配置说明：
location用于匹配 URL，语法如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>location <span class="token punctuation">[</span> <span class="token operator">=</span> <span class="token operator">|</span> <span class="token operator">~</span> <span class="token operator">|</span> <span class="token operator">~</span><span class="token operator">*</span> <span class="token operator">|</span> <span class="token operator">^</span><span class="token operator">~</span> <span class="token punctuation">]</span> uri <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
<span class="token operator">=</span> ：用于不含正则表达式的 uri 前，要求请求字符串与 uri 严格匹配，如果匹配成功，就停止继续向下搜索并立即处理该请求。
<span class="token operator">~</span>：用于表示 uri 包含正则表达式，并且区分大小写。
<span class="token operator">~</span><span class="token operator">*</span>：用于表示 uri 包含正则表达式，并且不区分大小写。
<span class="token operator">^</span><span class="token operator">~</span>：用于不含正则表达式的 uri 前，要求 <span class="token class-name">Nginx</span> 服务器找到标识 uri 和请求字符串匹配度最高的 location 后，立即使用此 location 处理请求，而不再使用 location块中的正则 uri 和请求字符串做匹配。
注意：如果uri包含正则表达式，则必须要有 <span class="token operator">~</span> 或者 <span class="token operator">~</span><span class="token operator">*</span> 标识。

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="_5-3-安装成系统服务-开机自启"><a href="#_5-3-安装成系统服务-开机自启" class="header-anchor">#</a> 5.3 安装成系统服务，开机自启</h3> <ul><li>创建服务脚本
vi /usr/lib/systemd/system/nginx.service</li> <li>服务脚本内容</li></ul> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token punctuation">[</span><span class="token class-name">Unit</span><span class="token punctuation">]</span>
<span class="token class-name">Description</span><span class="token operator">=</span>nginx <span class="token operator">-</span> web server
<span class="token class-name">After</span><span class="token operator">=</span>network<span class="token punctuation">.</span>target remote<span class="token operator">-</span>fs<span class="token punctuation">.</span>target nss<span class="token operator">-</span>lookup<span class="token punctuation">.</span>target
<span class="token punctuation">[</span><span class="token class-name">Service</span><span class="token punctuation">]</span>
<span class="token class-name">Type</span><span class="token operator">=</span>forking
<span class="token class-name">PIDFile</span><span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>logs<span class="token operator">/</span>nginx<span class="token punctuation">.</span>pid
<span class="token class-name">ExecStartPre</span><span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>sbin<span class="token operator">/</span>nginx <span class="token operator">-</span>t <span class="token operator">-</span>c <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>conf<span class="token operator">/</span>nginx<span class="token punctuation">.</span>conf
<span class="token class-name">ExecStart</span><span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>sbin<span class="token operator">/</span>nginx <span class="token operator">-</span>c <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>conf<span class="token operator">/</span>nginx<span class="token punctuation">.</span>conf
<span class="token class-name">ExecReload</span><span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>sbin<span class="token operator">/</span>nginx <span class="token operator">-</span>s reload
<span class="token class-name">ExecStop</span><span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>sbin<span class="token operator">/</span>nginx <span class="token operator">-</span>s stop
<span class="token class-name">ExecQuit</span><span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>sbin<span class="token operator">/</span>nginx <span class="token operator">-</span>s quit
<span class="token class-name">PrivateTmp</span><span class="token operator">=</span><span class="token boolean">true</span>
<span class="token punctuation">[</span><span class="token class-name">Install</span><span class="token punctuation">]</span>
<span class="token class-name">WantedBy</span><span class="token operator">=</span>multi<span class="token operator">-</span>user<span class="token punctuation">.</span>target

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><ul><li><p>重新加载系统服务
systemctl daemon-reload</p></li> <li><p>启动服务
systemctl start nginx.service<br>
使用系统启动服务之前，建议先把之前启动的关闭，否则可能有冲突</p></li> <li><p>重新启动nginx服务
systemctl reload nginx</p></li> <li><p>开机启动<br>
systemctl enable nginx.service</p></li></ul> <h3 id="_5-4-启动与关闭-nginx"><a href="#_5-4-启动与关闭-nginx" class="header-anchor">#</a> 5.4 启动与关闭 nginx</h3> <h4 id="_1-停止nginx服务的四种方法"><a href="#_1-停止nginx服务的四种方法" class="header-anchor">#</a> 1.停止Nginx服务的四种方法</h4> <p>从容停止服务</p> <p>这种方法较stop相比就比较温和一些了，需要进程完成当前工作后再停止。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>nginx <span class="token operator">-</span>s quit

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>立即停止服务</p> <p>这种方法比较强硬，无论进程是否在工作，都直接停止进程。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>nginx <span class="token operator">-</span>s stop

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>systemctl 停止</p> <p>systemctl属于Linux命令</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>systemctl stop nginx<span class="token punctuation">.</span>service

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>killall 方法杀死进程</p> <p>直接杀死进程，在上面无效的情况下使用，态度强硬，简单粗暴！</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>killall nginx

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_2-启动nginx"><a href="#_2-启动nginx" class="header-anchor">#</a> 2.启动Nginx</h4> <p>nginx直接启动</p> <p>nginx</p> <p>systemctl命令启动</p> <p>systemctl start nginx.service</p> <h4 id="_3-查看启动后记录"><a href="#_3-查看启动后记录" class="header-anchor">#</a> 3.查看启动后记录</h4> <div class="language-java line-numbers-mode"><pre class="language-java"><code>ps aux <span class="token operator">|</span> grep nginx

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_4-重启nginx服务"><a href="#_4-重启nginx服务" class="header-anchor">#</a> 4.重启Nginx服务</h4> <p>systemctl restart nginx.service</p> <h4 id="_5-重新载入配置文件"><a href="#_5-重新载入配置文件" class="header-anchor">#</a> 5.重新载入配置文件</h4> <p>当有系统配置文件有修改，用此命令，建议不要停止再重启，以防报错！</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>nginx <span class="token operator">-</span>s reload

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_6-查看端口号"><a href="#_6-查看端口号" class="header-anchor">#</a> 6.查看端口号</h4> <div class="language-java line-numbers-mode"><pre class="language-java"><code>netstat <span class="token operator">-</span>tlnp

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="nginx-配置环境变量"><a href="#nginx-配置环境变量" class="header-anchor">#</a> nginx 配置环境变量</h3> <p>环境变量配置文件</p> <p>如想将一个路径加入到$PATH中，可以像下面这样做：</p> <h4 id="_1-控制台中"><a href="#_1-控制台中" class="header-anchor">#</a> 1. 控制台中：</h4> <p>$ PATH=&quot;$PATH:/my_new_path&quot;    (关闭shell，会还原PATH)</p> <h4 id="_2-修改profile文件"><a href="#_2-修改profile文件" class="header-anchor">#</a> 2. 修改profile文件：</h4> <div class="language-java line-numbers-mode"><pre class="language-java"><code>$ vi <span class="token operator">/</span>etc<span class="token operator">/</span>profile

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>以交叉编译环境为例：</p> <p>交叉编译工具器在 /usr/local/nginx/sbin</p> <p>找到下面内容</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">&quot;$EUID&quot;</span> <span class="token operator">=</span> <span class="token string">&quot;0&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> then

pathmunge <span class="token operator">/</span>sbin

pathmunge <span class="token operator">/</span>usr<span class="token operator">/</span>sbin

pathmunge <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>sbin

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>在这个后面加上: pathmunge /usr/local/nginx/sbin</p> <p>之后执行命令：source /etc/profile   （nginx 就可以生效了）</p> <h4 id="_3-修改-bashrc文件"><a href="#_3-修改-bashrc文件" class="header-anchor">#</a> 3. 修改.bashrc文件：</h4> <div class="language-java line-numbers-mode"><pre class="language-java"><code>
$ vi <span class="token operator">/</span>root<span class="token operator">/</span><span class="token punctuation">.</span>bashrc

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>在里面加入：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>
export PATH<span class="token operator">=</span><span class="token string">&quot;$PATH:/my_new_path&quot;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>后两种方法一般需要重新注销系统才能生效，最后可以通过echo命令测试一下：</p> <p>$ echo $PATH</p> <p>输出已经是新路径了。</p> <p>举个列子，如果想把当前路径加入到环境变量中去，就可以这样做：</p> <p>$   PATH =&quot;$PATH:.&quot;</p> <p>这样运行自己编写的shell脚本时就可以不输入./了。</p> <p><strong>注意</strong>： 服务是服务 exe是exe ，服务是后台运行的，而配置在环境变量中的bin是运行在前台的程序；</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">5/17/2022, 12:02:13 PM</span></div></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/90.工具部署/02.Nginx/notes/2Nginx基础.html">
        Nginx尚硅谷
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.19543062.js" defer></script><script src="/assets/js/2.0ee43227.js" defer></script><script src="/assets/js/105.8d220a0b.js" defer></script>
  </body>
</html>
