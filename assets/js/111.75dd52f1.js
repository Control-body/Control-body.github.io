(window.webpackJsonp=window.webpackJsonp||[]).push([[111],{510:function(s,t,a){"use strict";a.r(t);var n=a(56),v=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"多环境"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#多环境"}},[s._v("#")]),s._v(" 多环境")]),s._v(" "),a("p",[s._v("参考文章：https://blog.csdn.net/weixin_41701290/article/details/120173283")]),s._v(" "),a("p",[s._v("本地开发：localhost（127.0.0.1）")]),s._v(" "),a("p",[s._v("多环境：指同一套项目代码在不同的阶段需要根据实际情况来调整配置并且部署到不同的机器上。")]),s._v(" "),a("p",[s._v("为什么需要？")]),s._v(" "),a("ol",[a("li",[s._v("每个环境互不影响")]),s._v(" "),a("li",[s._v("区分不同的阶段：开发 / 测试 / 生产")]),s._v(" "),a("li",[s._v("对项目进行优化：\n"),a("ol",[a("li",[s._v("本地日志级别")]),s._v(" "),a("li",[s._v("精简依赖，节省项目体积")]),s._v(" "),a("li",[s._v("项目的环境 / 参数可以调整，比如 JVM 参数")])])])]),s._v(" "),a("p",[s._v("针对不同环境做不同的事情。")]),s._v(" "),a("p",[s._v("多环境分类：")]),s._v(" "),a("ol",[a("li",[s._v("本地环境（自己的电脑）localhost")]),s._v(" "),a("li",[s._v("开发环境（远程开发）大家连同一台机器，为了大家开发方便")]),s._v(" "),a("li",[s._v("测试环境（测试）开发 / 测试 / 产品，单元测试 / 性能测试 / 功能测试 / 系统集成测试，独立的数据库、独立的服务器")]),s._v(" "),a("li",[s._v("预发布环境（体验服）：和正式环境一致，正式数据库，更严谨，查出更多问题")]),s._v(" "),a("li",[s._v("正式环境（线上，公开对外访问的项目）：尽量不要改动，保证上线前的代码是 “完美” 运行")]),s._v(" "),a("li",[s._v("沙箱环境（实验环境）：为了做实验")])]),s._v(" "),a("h3",{attrs:{id:"前端多环境实战"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前端多环境实战"}},[s._v("#")]),s._v(" 前端多环境实战")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("请求地址")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("开发环境：localhost:8000")])]),s._v(" "),a("li",[a("p",[s._v("线上环境：user-backend.code-nav.cn")])])]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("startFront")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("env")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("env "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'prod'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 不输出注释 ")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 项目优化")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 修改请求地址")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 保持本地开发逻辑")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("用了 umi 框架，build 时会自动传入 NODE_ENV == production 参数，start NODE_ENV 参数为 development")])]),s._v(" "),a("li",[a("p",[s._v("启动方式")]),s._v(" "),a("ul",[a("li",[s._v("开发环境：npm run start（本地启动，监听端口、自动更新）")]),s._v(" "),a("li",[s._v("线上环境：npm run build（项目构建打包），可以使用 serve 工具启动（npm i -g serve）")])])]),s._v(" "),a("li",[a("p",[s._v("项目的配置")]),s._v(" "),a("p",[s._v("不同的项目（框架）都有不同的配置文件，umi 的配置文件是 config，可以在配置文件后添加对应的环境名称后缀来区分开发环境和生产环境。参考文档：https://umijs.org/zh-CN/docs/deployment")]),s._v(" "),a("ul",[a("li",[s._v("开发环境：config.dev.ts")]),s._v(" "),a("li",[s._v("生产环境：config.prod.ts")]),s._v(" "),a("li",[s._v("公共配置：config.ts 不带后缀")])])])]),s._v(" "),a("h3",{attrs:{id:"后端多环境实战"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#后端多环境实战"}},[s._v("#")]),s._v(" 后端多环境实战")]),s._v(" "),a("p",[s._v("SpringBoot 项目，通过 application.yml 添加不同的后缀来区分配置文件")]),s._v(" "),a("p",[s._v("可以在启动项目时传入环境变量：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("java -jar ."),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("user-center-backend-0.0.1-SNAPSHOT.jar --spring.profiles.active"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("prod\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("主要是改：")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("依赖的环境地址")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("数据库地址")])]),s._v(" "),a("li",[a("p",[s._v("缓存地址")])]),s._v(" "),a("li",[a("p",[s._v("消息队列地址")])]),s._v(" "),a("li",[a("p",[s._v("项目端口号")])])])]),s._v(" "),a("li",[a("p",[s._v("服务器配置")])])])])}),[],!1,null,null,null);t.default=v.exports}}]);