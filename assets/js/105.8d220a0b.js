(window.webpackJsonp=window.webpackJsonp||[]).push([[105],{504:function(s,a,t){"use strict";t.r(a);var n=t(56),r=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"_1-什么是nginx"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-什么是nginx"}},[s._v("#")]),s._v(" 1. 什么是Nginx?")]),s._v(" "),t("p",[s._v("Nginx (engine x) 是一个高性能的HTTP和反向代理web服务器，同时也提供了IMAP/POP3/SMTP服务。")]),s._v(" "),t("p",[s._v("Nginx是由伊戈尔·赛索耶夫为俄罗斯访问量第二的Rambler.ru站点（俄文：Рамблер）开发的。")]),s._v(" "),t("p",[s._v("Nginx的特点是占有内存少，并发能力强，能够支持高达 50,000 个并发连接数的响应,事实上nginx的并发能力在同类型的网页服务器中表现较好，中国大陆使用nginx网站用户有：百度、京东、新浪、网易、腾讯、淘宝等。")]),s._v(" "),t("p",[s._v("Nginx支持正向代理、反向代理、负载均衡和动静分离。接下来一一介绍。")]),s._v(" "),t("h3",{attrs:{id:"_1-1-正向代理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-正向代理"}},[s._v("#")]),s._v(" 1.1 正向代理")]),s._v(" "),t("p",[s._v("在如今的网络环境下，我们如果由于技术需要要去访问国外的某些网站，此时你会发现位于国外的某网站我们通过浏览器是没有办法访问的，此时大家可能都会用一个代理(vpn)进行访问，代理的方式主要是找到一个可以访问国外网站的代理服务器，我们将请求发送给代理服务器，代理服务器去访问国外的网站，然后将访问到的数据传递给我们！")]),s._v(" "),t("p",[s._v('Nginx支持正向代理，"它代理的是客户端"，是一个位于客户端和原始服务器(origin server)之间的服务器，为了从原始服务器取得内容，客户端向代理发送一个请求并指定目标(原始服务器)，然后代理向原始服务器转交请求并将获得的内容返回给客户端。客户端必须要进行一些特别的设置才能使用正向代理。')]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-a4c65b10c74e4442bec396fea227119c.png",alt:"image.png"}})]),s._v(" "),t("p",[s._v("客户端必须设置正向代理服务器，当然前提是要知道正向代理服务器的IP地址，还有代理程序的端口。如图。\n"),t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-124e8ff675114c1cb93416f1fe30c912.png",alt:"image.png"}})]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-1c89f0a0fed742e7868b4852262709bb.png",alt:"image.png"}}),s._v(" "),t("strong",[s._v("正向代理的用途：")]),s._v("\n（1）访问原来无法访问的资源，如Google\n（2） 可以做缓存，加速访问资源\n（3）对客户端访问授权，上网进行认证\n（4）代理可以记录用户访问记录（上网行为管理），对外隐藏用户信息")]),s._v(" "),t("h3",{attrs:{id:"_1-2-反向代理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-反向代理"}},[s._v("#")]),s._v(" 1.2 反向代理")]),s._v(" "),t("p",[s._v("明白了什么是正向代理，我们继续看关于反向代理的处理方式，举例如我大天朝的某宝网站，每天同时连接到网站的访问人数已经爆表，单个服务器远远不能满足人民日益增长的购买欲望了，此时就出现了一个大家耳熟能详的名词：分布式部署；也就是通过部署多台服务器来解决访问人数限制的问题；某宝网站中大部分功能也是直接使用Nginx进行反向代理实现的，并且通过封装Nginx和其他的组件之后起了个高大上的名字：Tengine，有兴趣的童鞋可以访问Tengine的官网查看具体的信息：http://tengine.taobao.org/。")]),s._v(" "),t("p",[s._v("Tengine是一个由淘宝网发起的Web服务器开源项目，其核心成员来自于淘宝 、搜狗 等互联网企业。它在Nginx 的基础上，针对大访问量网站的需求，添加了很多高级功能和特性。Tengine的性能和稳定性已经在大型的网站如淘宝网 ，天猫商城 等得到了很好的检验。它的最终目标是打造一个高效、稳定、安全、易用的Web平台。")]),s._v(" "),t("p",[s._v("Nginx支持"),t("strong",[s._v("反向代理")]),s._v('，"它代理的是服务端，代服务端接收请求"，主要用于服务器集群分布式部署的情况下，'),t("strong",[s._v("反向代理隐藏了服务器的信息")]),s._v("。多个客户端给服务器发送的请求，Nginx服务器接收到之后，按照一定的规则分发给了后端的业务处理服务器进行处理了。请求的来源也就是客户端是明确的，但是请求具体由哪台服务器处理的并不明确了，Nginx扮演的就是一个反向代理角色。\n"),t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-ca93743096534d1282c0b7a53ebf893b.png",alt:"image.png"}})]),s._v(" "),t("p",[s._v("反向代理的作用：\n（1）保证内网的安全，通常将反向代理作为公网访问地址，Web服务器是内网。\n（2）负载均衡，通过反向代理服务器来优化网站的负载")]),s._v(" "),t("h3",{attrs:{id:"_1-3-正向代理与反向代理的应用场景"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-正向代理与反向代理的应用场景"}},[s._v("#")]),s._v(" 1.3 正向代理与反向代理的应用场景")]),s._v(" "),t("p",[s._v("通常情况下，我们在实际项目操作时，正向代理和反向代理很有可能会存在在"),t("strong",[s._v("一个应用场景中")]),s._v("，正向代理代理客户端的请求去访问目标服务器，目标服务器是一个反向代理服务器，反向代理了多台真实的业务处理服务器。具体的拓扑图如下：")]),s._v(" "),t("h3",{attrs:{id:"_1-4-正向代理与反向代理的区别"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-正向代理与反向代理的区别"}},[s._v("#")]),s._v(" 1.4 正向代理与反向代理的区别")]),s._v(" "),t("p",[s._v("通过一张图来说明正向代理和反向代理二者之间的区别：\n"),t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-0a22e070bcb14d2caf1a4ffd868f3b5c.png",alt:"image.png"}}),s._v("\n图解：")]),s._v(" "),t("p",[s._v("在正向代理中，Proxy和Client同属于一个LAN（图中方框内），隐藏了客户端信息；")]),s._v(" "),t("p",[s._v("在反向代理中，Proxy和Server同属于一个LAN（图中方框内），隐藏了服务端信息；")]),s._v(" "),t("p",[s._v("实际上，Proxy在两种代理中做的事情都是替服务器代为收发请求和响应，不过从结构上看正好左右互换了一下，所以把后出现的那种代理方式称为反向代理了。")]),s._v(" "),t("h3",{attrs:{id:"_1-5-负载均衡"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-5-负载均衡"}},[s._v("#")]),s._v(" 1.5 负载均衡")]),s._v(" "),t("p",[s._v("我们已经明确了所谓代理服务器的概念，那么接下来，Nginx扮演了反向代理服务器的角色，它是以依据什么样的规则进行请求分发的呢？不用的项目应用场景，分发的规则是否可以控制呢？")]),s._v(" "),t("p",[s._v("我们把客户端发送的、Nginx反向代理服务器接收到的"),t("strong",[s._v("请求数量")]),s._v("，就是我们说的"),t("strong",[s._v("负载量")]),s._v("。")]),s._v(" "),t("p",[s._v("请求数量按照一定的规则进行分发到不同的服务器处理的规则，就是一种均衡规则。")]),s._v(" "),t("p",[s._v("将服务器接收到的请求按照规则分发的过程，称为"),t("strong",[s._v("负载均衡")]),s._v("。")]),s._v(" "),t("p",[s._v("负载均衡在实际项目操作过程中，有"),t("strong",[s._v("硬件")]),s._v("负载均衡和"),t("strong",[s._v("软件")]),s._v("负载均衡两种，硬件负载均衡也称为硬负载，如F5负载均衡，相对造价昂贵成本较高，但是数据的"),t("strong",[s._v("稳定性安全性")]),s._v("等等有非常好的保障，如中国移动中国联通这样的公司才会选择硬负载进行操作；更多的公司考虑到成本原因，会选择使用软件负载均衡，软件负载均衡是利用现有的技术结合主机硬件实现的一种"),t("strong",[s._v("消息队列分发机制")]),s._v("。\n"),t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-04a855b232244076a48e57536f1a6e13.png",alt:"image.png"}}),s._v("\nNginx支持的负载均衡调度算法方式如下：")]),s._v(" "),t("ol",[t("li",[s._v("weight轮询（默认，常用，具有HA功效！）：接收到的请求按照权重分配到不同的后端服务器，即使在使用过程中，某一台后端服务器宕机，Nginx会自动将该服务器剔除出队列，请求受理情况不会受到任何影响。 这种方式下，可以给不同的后端服务器设置一个权重值(weight)，用于调整不同的服务器上请求的分配率；权重数据越大，被分配到请求的几率越大；该权重值，主要是针对实际工作环境中不同的后端服务器硬件配置进行调整的。")]),s._v(" "),t("li",[s._v("ip_hash（常用）：每个请求按访问ip的hash结果分配，这样每个访客固定访问一个后端服务器，这也在一定程度上解决了集群部署环境下session共享的问题。")]),s._v(" "),t("li",[s._v("fair：智能调整调度算法，动态的根据后端服务器的请求处理到响应的时间进行均衡分配，响应时间短处理效率高的服务器分配到请求的概率高，响应时间长处理效率低的服务器分配到的请求少；结合了前两者的优点的一种调度算法。但是需要注意的是Nginx默认不支持fair算法，如果要使用这种调度算法，请安装upstream_fair模块。")]),s._v(" "),t("li",[s._v("url_hash：按照访问的url的hash结果分配请求，每个请求的url会指向后端固定的某个服务器，可以在Nginx作为静态服务器的情况下提高缓存效率。同样要注意Nginx默认不支持这种调度算法，要使用的话需要安装Nginx的hash软件包。")])]),s._v(" "),t("h3",{attrs:{id:"_1-6-动静分离"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-6-动静分离"}},[s._v("#")]),s._v(" 1.6 动静分离")]),s._v(" "),t("p",[s._v("为了提高网站的响应速度，减轻程序服务器（Tomcat，Jboss等）的负载，对于静态资源比如图片，js，css等文件，我们可以在Nginx反向代理服务器中进行缓存，这样浏览器在请求一个静态资源时，Nginx代理服务器就可以直接处理，而不用将请求转发给后端服务器。用户请求的动态文件比如"),t("strong",[s._v("servlet,jsp则转发给Tomcat")]),s._v("，Jboss服务器处理，这就是"),t("strong",[s._v("动静分离")]),s._v("。\n"),t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-d7225c6b2a28482bafaf8324f5ff992a.png",alt:"image.png"}})]),s._v(" "),t("h3",{attrs:{id:"_1-7-几种常用web服务器对比"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-7-几种常用web服务器对比"}},[s._v("#")]),s._v(" 1.7 几种常用web服务器对比")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-d91615408a1b44bdaeefc596f0198d52.png",alt:"image.png"}})]),s._v(" "),t("h2",{attrs:{id:"_2-linux安装nginx"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-linux安装nginx"}},[s._v("#")]),s._v(" 2. Linux安装Nginx")]),s._v(" "),t("h3",{attrs:{id:"安装-nginx-前-必须安装-pcre-ubuntu操作系统的时候"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装-nginx-前-必须安装-pcre-ubuntu操作系统的时候"}},[s._v("#")]),s._v(" 安装 Nginx 前 必须安装 PCRE（Ubuntu操作系统的时候）")]),s._v(" "),t("p",[s._v("Nginx是高度自由化的Web服务器，它的功能是由许多模块来支持。如果使用了某个模块，这个模块使用了一些类似zlib或OpenSSL等的第三方库，那么就必须先安装这些软件。Ubuntu下不像在centOS中使用yum直接在线安装，可以使用以下方法。")]),s._v(" "),t("h4",{attrs:{id:"_1-pcre库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-pcre库"}},[s._v("#")]),s._v(" （1）PCRE库")]),s._v(" "),t("p",[s._v("PCRE库支持正则表达式。如果我们在配置文件nginx.conf中使用了正则表达式，那么在编译Nginx时就必须把PCRE库编译进Nginx，因为Nginx的HTTP模块需要靠它来解析正则表达式。另外，pcre-devel是使用PCRE做二次开发时所需要的开发库，包括头文件等，这也是编译Nginx所必须使用的。可以这样安装：")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("\nsudo apt"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("get install libpcre3 libpcre3"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dev  \n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h4",{attrs:{id:"_2-zlib库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-zlib库"}},[s._v("#")]),s._v(" （2）zlib库")]),s._v(" "),t("p",[s._v("zlib库用于对HTTP包的内容做gzip格式的压缩，如果我们在nginx.conf中配置了gzip on，并指定对于某些类型（content-type）的HTTP响应使用gzip来进行压缩以减少网络传输量，则在编译时就必须把zlib编译进Nginx。zlib-devel是二次开发所需要的库。可以这样安装：")]),s._v(" "),t("p",[s._v("sudo apt-get install zlib1g-dev")]),s._v(" "),t("h4",{attrs:{id:"_3-openssl库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-openssl库"}},[s._v("#")]),s._v(" （3）OpenSSL库")]),s._v(" "),t("p",[s._v("如果服务器不只是要支持HTTP，还需要在更安全的SSL协议上传输HTTP，那么需要拥有OpenSSL。另外，如果我们想使用MD5、SHA1等散列函数，那么也需要安装它。可以这样安装：")]),s._v(" "),t("p",[s._v("sudo apt-get install openssl libssl-dev\n网址：https://blog.csdn.net/somanlee/article/details/69808788?utm_source=copy")]),s._v(" "),t("p",[s._v("最好在更新一下 openssl")]),s._v(" "),t("p",[s._v("但是升级了 openssl nginx 安装 --with-http_ssl_module 会报错 （所以我 为了开启 --with-http_ssl_module 没有升级 openssl 不升级也没什么关系 哈哈哈）")]),s._v(" "),t("p",[s._v("不升级  openssl  能正常编译安装 nginx --with-http_ssl_module   切记切记")]),s._v(" "),t("h3",{attrs:{id:"安装nginx"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装nginx"}},[s._v("#")]),s._v(" 安装Nginx")]),s._v(" "),t("p",[s._v("下载地址：https://nginx.org/en/download.html")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@centos7601")]),s._v(" nginx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# wget https"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("org"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("download"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.18")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tar"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gz\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@centos7601")]),s._v(" nginx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# ll\n总用量 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3072")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("rw"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("r"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("r"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2090750")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("月  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v(" download\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("rw"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("r"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("r"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1039530")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("月  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v(" nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.18")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tar"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gz\ndrwxr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("xr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1169")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1169")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12288")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("月  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("39")]),s._v(" pcre"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8.44")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@centos7601")]),s._v(" nginx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# tar "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("zxvf nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.18")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tar"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gz \n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@centos7601")]),s._v(" nginx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# ll\n总用量 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3076")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("rw"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("r"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("r"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2090750")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("月  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v(" download\ndrwxr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("xr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("月  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v(" nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.18")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("rw"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("r"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("r"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1039530")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("月  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v(" nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.18")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tar"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gz\ndrwxr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("xr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1169")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1169")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12288")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("月  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("39")]),s._v(" pcre"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8.44")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@centos7601")]),s._v(" nginx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# cd nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.18")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@centos7601")]),s._v(" nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.18")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("/configure \n# 安装成功之后，在"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr下多出来一个文件夹local"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx，在"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sbin有启动脚本 一定要在"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("url中修改否则不生效\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@centos7601")]),s._v(" sbin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# pwd\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sbin\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@centos7601")]),s._v(" sbin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# ll\n总用量 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3764")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("rwxr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("xr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3852280")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("月  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("01")]),s._v(" nginx\n# 启动nginx\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@centos7601")]),s._v(" sbin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("/nginx\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@centos7601")]),s._v(" sbin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# ps "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ef "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("grep nginx\nroot      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("60890")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("05")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),s._v(" nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" master process "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("/nginx\nnobody    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("60892")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("60890")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("05")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),s._v(" nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" worker process\nroot      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("60907")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127532")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("05")]),s._v(" pts"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),s._v(" grep "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("color"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("auto nginx\n# 测试"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Nginx")]),s._v("是否成功，查看ip，然后网址输入ip地址可转到一个"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Nginx")]),s._v("测试网页，这里只展示部分命令结果\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@centos7601")]),s._v(" sbin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# ifconfig\nens33"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" flags"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4163")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("UP"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("BROADCAST"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("RUNNING"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("MULTICAST"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("  mtu "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1500")]),s._v("\n        inet "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".14")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".128")]),s._v("  netmask "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("255.255")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".255")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),s._v("  broadcast "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".14")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".255")]),s._v("\n        inet6 fe80"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("eb2"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("b749"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("c806"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("c97  prefixlen "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v("  scopeid "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x20")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("link"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        ether "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("c"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("29")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("61")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("e  txqueuelen "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Ethernet")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        RX packets "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("507925")]),s._v("  bytes "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("738941851")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("704.7")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("MiB")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        RX errors "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  dropped "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  overruns "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  frame "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n        TX packets "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("158188")]),s._v("  bytes "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10510448")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("MiB")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        TX errors "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  dropped "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" overruns "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  carrier "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  collisions "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br")])]),t("h3",{attrs:{id:"开启防火墙"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#开启防火墙"}},[s._v("#")]),s._v(" 开启防火墙")]),s._v(" "),t("p",[s._v("nginx默认是监听80 端口；")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("\n# 由于我的"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Linxu")]),s._v("虚拟机"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("端口未开，所以需要对防火墙进行配置\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@centos7601")]),s._v(" sbin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# firewall"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("cmd "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("list"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("all\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("active"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  target"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v("\n  icmp"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("block"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("inversion"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" no\n  interfaces"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" ens33\n  sources"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" \n  services"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" ssh dhcpv6"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("client\n  ports"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("tcp\n  protocols"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" \n  masquerade"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" no\n  forward"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ports"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" \n  source"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ports"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" \n  icmp"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("blocks"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" \n  rich rules"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" \n\t\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@centos7601")]),s._v(" sbin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# firewall"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("cmd "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("permanent "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("add"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("port"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("tcp\nsuccess\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@centos7601")]),s._v(" sbin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# firewall"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("cmd "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("reload\nsuccess\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@centos7601")]),s._v(" sbin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# firewall"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("cmd "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("query"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("port"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("tcp\nyes\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@centos7601")]),s._v(" sbin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# firewall"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("cmd "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("list"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("all\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("active"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  target"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v("\n  icmp"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("block"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("inversion"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" no\n  interfaces"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" ens33\n  sources"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" \n  services"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" ssh dhcpv6"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("client\n  ports"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("tcp "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("tcp\n  protocols"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" \n  masquerade"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" no\n  forward"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ports"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" \n  source"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ports"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" \n  icmp"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("blocks"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" \n  rich rules"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-537aa61f3353459bad9390263b47c835.png",alt:"image.png"}})]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-1d64c05e37384ae89edf034ca80cf2cc.png",alt:"image.png"}})]),s._v(" "),t("h3",{attrs:{id:"centos-安装-nginx"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#centos-安装-nginx"}},[s._v("#")]),s._v(" CentOS 安装 Nginx")]),s._v(" "),t("h4",{attrs:{id:"a-依赖环境安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#a-依赖环境安装"}},[s._v("#")]),s._v(" A. 依赖环境安装")]),s._v(" "),t("p",[s._v("要安装 nginx，要先安装 nginx 的依赖环境：gcc-c++、openssl、pcre、zlib")]),s._v(" "),t("h5",{attrs:{id:"_1-安装-gcc-c-编译器和-openssl"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-安装-gcc-c-编译器和-openssl"}},[s._v("#")]),s._v(" 1. 安装 gcc-c++ 编译器和 openssl")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("\nyum install gcc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("c"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),s._v(" \nyum install "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("y openssl openssl"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("devel\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h5",{attrs:{id:"_2-安装-pcre-包"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-安装-pcre-包"}},[s._v("#")]),s._v(" 2. 安装 pcre 包")]),s._v(" "),t("p",[s._v("yum install -y pcre pcre-devel")]),s._v(" "),t("h5",{attrs:{id:"_3-再安装-zlib-包"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-再安装-zlib-包"}},[s._v("#")]),s._v(" 3. 再安装 zlib 包")]),s._v(" "),t("p",[s._v("yum install -y zlib zlib-devel")]),s._v(" "),t("h4",{attrs:{id:"b-nginx-安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#b-nginx-安装"}},[s._v("#")]),s._v(" B. Nginx 安装")]),s._v(" "),t("p",[s._v("依赖环境安装完成后，我们开始安装 nginx")]),s._v(" "),t("h5",{attrs:{id:"_1-在-usr-local-目录下创建-nginx-文件夹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-在-usr-local-目录下创建-nginx-文件夹"}},[s._v("#")]),s._v(" 1. 在 /usr/local/ 目录下创建 nginx 文件夹")]),s._v(" "),t("p",[s._v("cd /usr/local\nmkdir nginx")]),s._v(" "),t("h5",{attrs:{id:"_2-使用-wget-命令直接下载-nginx-安装包-也可以直接上传下载好的压缩包"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-使用-wget-命令直接下载-nginx-安装包-也可以直接上传下载好的压缩包"}},[s._v("#")]),s._v(" 2. 使用 wget 命令直接下载 nginx 安装包，也可以直接上传下载好的压缩包")]),s._v(" "),t("p",[s._v("wget https://nginx.org/download/nginx-1.14.0.tar.gz")]),s._v(" "),t("h5",{attrs:{id:"_3-解压并进入解压好的目录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-解压并进入解压好的目录"}},[s._v("#")]),s._v(" 3. 解压并进入解压好的目录")]),s._v(" "),t("p",[s._v("tar -zxvf nginx-1.14.0.tar.gz\ncd nginx-1.14.0/")]),s._v(" "),t("h5",{attrs:{id:"_4-使用-nginx-默认配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-使用-nginx-默认配置"}},[s._v("#")]),s._v(" 4. 使用 nginx 默认配置")]),s._v(" "),t("p",[s._v("./configure")]),s._v(" "),t("h5",{attrs:{id:"_5-编译安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-编译安装"}},[s._v("#")]),s._v(" 5. 编译安装")]),s._v(" "),t("p",[s._v("make\nmake install")]),s._v(" "),t("p",[s._v("如果没有报错，那么你的 /usr/local/nginx目录会多些除了红框之外的东西如下\n"),t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-6249509ddca04ee9a040ec1a979ec639.png",alt:"image.png"}})]),s._v(" "),t("h5",{attrs:{id:"_6-进入-usr-local-nginx-sbin-目录执行启动命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-进入-usr-local-nginx-sbin-目录执行启动命令"}},[s._v("#")]),s._v(" 6. 进入 /usr/local/nginx/sbin 目录执行启动命令")]),s._v(" "),t("p",[s._v("就算下载在其他的位置，编译之后也会 放在/usr/local/nginx/...下面")]),s._v(" "),t("p",[s._v("./nginx")]),s._v(" "),t("h5",{attrs:{id:"_7-查看是否启动成功"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-查看是否启动成功"}},[s._v("#")]),s._v(" 7. 查看是否启动成功")]),s._v(" "),t("p",[s._v("ps -ef | grep nginx\n"),t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-52e17dcfbf8e47adbf95246e7c5830ac.png",alt:"image.png"}})]),s._v(" "),t("h2",{attrs:{id:"_3-nginx常用命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-nginx常用命令"}},[s._v("#")]),s._v(" 3. Nginx常用命令")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("# 查看nginx版本信息\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@centos7601")]),s._v(" sbin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("/nginx "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("v \nnginx version"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.18")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@centos7601")]),s._v(" sbin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# ps "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ef "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("grep nginx\nroot      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("62288")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),s._v(" nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" master process "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("/nginx\nnobody    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("62290")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("62288")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),s._v(" nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" worker process\nroot      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("62325")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127532")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(" pts"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),s._v(" grep "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("color"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("auto nginx\n# 关闭nginx\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@centos7601")]),s._v(" sbin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("/nginx "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("s stop\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@centos7601")]),s._v(" sbin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# ps "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ef "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("grep nginx\nroot      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("62346")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127532")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(" pts"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),s._v(" grep "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("color"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("auto nginx\n# 重新加载nginx，前提是nginx已启动\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@centos7601")]),s._v(" sbin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("/nginx "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("s reload\nnginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("error"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("open")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/local/nginx/logs/nginx.pid"')]),s._v(" failed "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("No")]),s._v(" such file or directory"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n# 启动nginx\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@centos7601")]),s._v(" sbin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("/nginx \n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@centos7601")]),s._v(" sbin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# ps "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ef "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("grep nginx\nroot      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("62428")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),s._v(" nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" master process "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("/nginx\nnobody    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("62430")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("62428")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),s._v(" nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" worker process\nroot      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("62442")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127532")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" pts"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),s._v(" grep "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("color"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("auto nginx\n# 重新加载nginx，前提是nginx已启动\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@centos7601")]),s._v(" sbin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("/nginx "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("s reload\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@centos7601")]),s._v(" sbin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# ps "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ef "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("grep nginx\nroot      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("62428")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),s._v(" nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" master process "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("/nginx\nnobody    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("62453")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("62428")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),s._v(" nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" worker process\nroot      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("62465")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127532")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" pts"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),s._v(" grep "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("color"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("auto nginx\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br")])]),t("h2",{attrs:{id:"_4-nginx配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-nginx配置文件"}},[s._v("#")]),s._v(" 4. Nginx配置文件")]),s._v(" "),t("p",[s._v("配置文件的位置：/usr/local/nginx/conf/nginx.conf")]),s._v(" "),t("p",[s._v("nginx.conf分为三个模块：全局块、events块、http块")]),s._v(" "),t("h4",{attrs:{id:"_4-1-全局块"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-全局块"}},[s._v("#")]),s._v(" 4.1 全局块")]),s._v(" "),t("p",[s._v("全局块：从配置文件开始到 events 块之间的内容，主要会设置一些影响 Nginx 服务器整体运行的配置指令，配置服务器整体运行的配置指令。")]),s._v(" "),t("p",[s._v("主要包括：")]),s._v(" "),t("p",[s._v("1、配置运行 Nginx 服务器的用户（组）、\n2、允许生成的 worker process 数，\n3、进程 PID 存放路径、\n4、日志存放路径和类型\n5、配置文件的引入\n6、…")]),s._v(" "),t("h4",{attrs:{id:"_4-2-events块"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-events块"}},[s._v("#")]),s._v(" 4.2 events块")]),s._v(" "),t("p",[s._v("events 块涉及的指令主要影响 Nginx 服务器与用户的网络连接，常用的设置包括是否开启对多 work process 下的网络连接进行序列化，是否允许同时接收多个网络连接，选取哪种事件驱动模型来处理连接请求，每个 work process 可以同时支持的最大连接数等。")]),s._v(" "),t("h4",{attrs:{id:"_4-3-http块"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-http块"}},[s._v("#")]),s._v(" 4.3 http块")]),s._v(" "),t("p",[s._v("http块是 Nginx 服务器配置中最频繁的"),t("strong",[s._v("部分，代理、缓存和日志")]),s._v("定义等绝大多数功能和第三方模块的配置都在这里。")]),s._v(" "),t("p",[s._v("需要注意的是，http 块也可以包括:")]),s._v(" "),t("p",[s._v("● http 全局块\n● 多个server 块")]),s._v(" "),t("h5",{attrs:{id:"_4-3-1-http-全局块"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-1-http-全局块"}},[s._v("#")]),s._v(" 4.3.1 http 全局块")]),s._v(" "),t("p",[s._v("http 全局块配置的指令包括文件引入、 MIME-TYPE 定义、日志自定义、连接超时时间、单链接请求数上限等")]),s._v(" "),t("h5",{attrs:{id:"_4-3-2-server-块"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-2-server-块"}},[s._v("#")]),s._v(" 4.3.2 server 块")]),s._v(" "),t("p",[s._v("这块和虚拟主机有密切关系，虚拟主机从用户角度看，和单一独立的硬件主机是完全一样的，该技术的产生是为了节省互联网服务器硬件成本。")]),s._v(" "),t("p",[s._v("每个 http 块可以包括多个 server 块，而每个 server 块就相当于一个"),t("strong",[s._v("虚拟主机")]),s._v("。")]),s._v(" "),t("p",[s._v("而每个 server 块也分为：")]),s._v(" "),t("p",[s._v("● 全局 server 块\n● 多个 locaton 块")]),s._v(" "),t("h6",{attrs:{id:"_4-3-2-1-全局-server-块"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-2-1-全局-server-块"}},[s._v("#")]),s._v(" 4.3.2.1 全局 server 块")]),s._v(" "),t("p",[s._v("最常见的配置是本虚拟机主机的监听配置和"),t("strong",[s._v("本虚拟主机的名称或 IP 配置")]),s._v("。")]),s._v(" "),t("h6",{attrs:{id:"_4-3-2-2-location-块"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-2-2-location-块"}},[s._v("#")]),s._v(" 4.3.2.2 location 块")]),s._v(" "),t("p",[s._v("一个 server 块可以配置多个 location 块。")]),s._v(" "),t("p",[s._v("这块的主要作用是基于 Nginx 服务器接收到的"),t("strong",[s._v("请求字符串")]),s._v("（例如 server_name/uri-string），对虚拟主机名称（也可以是 IP 别名）之外的字符串（例如： /uri-string）进行匹配，对特定的请求进行处理。")]),s._v(" "),t("p",[s._v("4.4 配置文件的内容解析")]),s._v(" "),t("p",[s._v("更多内容可参考：")]),s._v(" "),t("p",[s._v("https://blog.csdn.net/wangbin_0729/article/details/82109693\nhttps://www.cnblogs.com/hunttown/p/5759959.html")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-a29f1df916d046e49973a4504266756d.png",alt:"image.png"}})]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("#指定了"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Nginx")]),s._v("要开启的进程数。\n#每个"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Nginx")]),s._v("进程平均耗费"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("M"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v("M内存。建议指定和CPU的数量一致即可。\nworker_processes "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n \n#定义全局错误日志文件。日志输出级别有debug、info、notice、warn、error、crit可供选择\n#其中，debug输出日志最为最详细，而crit输出日志最少。\nerror_log "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("logs"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("error"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("log info"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n#指定进程pid的存储文件位置\npid "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("logs"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pid"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n#指定进程可以打开的最大描述符：数目\n#工作模式与连接数上限\n#这个指令是指当一个nginx进程打开的最多文件描述符数目，理论值应该是最多打开文件数（ulimit "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("n）与nginx进程数相除，但是nginx分配请求并不是那么均匀，所以最好与ulimit "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("n 的值保持一致。\n#现在在linux "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.6")]),s._v("内核下开启文件打开数为"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("65535")]),s._v("，worker_rlimit_nofile就相应应该填写"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("65535")]),s._v("。\n#这是因为nginx调度时分配请求到进程并不是那么的均衡，所以假如填写"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10240")]),s._v("，总并发量达到"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("万时就有进程可能超过"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10240")]),s._v("了，这时会返回"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("502")]),s._v("错误。\nworker_rlimit_nofile "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("65535")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n# events事件指令是设定"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Nginx")]),s._v("的工作模式及连接数上限：\nevents\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    #events事件指令是设定"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Nginx")]),s._v("的工作模式及连接数上限：\n    #use是个事件模块指令，用来指定"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Nginx")]),s._v("的工作模式。\n    #"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Nginx")]),s._v("支持的工作模式有select、poll、kqueue、epoll、rtsig和"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("dev"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("poll。\n    #其中select和poll都是标准的工作模式，kqueue和epoll是高效的工作模式，不同的是epoll用在"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Linux")]),s._v("平台上，而kqueue用在BSD系统中。\n    #对于"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Linux")]),s._v("系统，epoll工作模式是首选。\n    use epoll"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    #worker_connections也是个事件模块指令，用于定义"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Nginx")]),s._v("每个进程的最大连接数，默认是"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),s._v("。\n    #最大客户端连接数由worker_processes和worker_connections决定，即"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Max_clients")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("worker_processes"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("worker_connections。\n    #在作为反向代理时，max_clients变为：max_clients "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" worker_processes "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" worker_connections"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("。\n\t#进程的最大连接数受"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Linux")]),s._v("系统进程的最大打开文件数限制，在执行操作系统命令“ulimit "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("n "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("65536")]),s._v("”后worker_connections的设置才能生效\n    worker_connections "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    #keepalive超时时间。\n    keepalive_timeout "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    #客户端请求头部的缓冲区大小。\n    #这个可以根据你的系统分页大小来设置，一般一个请求头的大小不会超过"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("k，不过由于一般系统分页都要大于"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("k，所以这里设置为分页大小。\n    #分页大小可以用命令getconf PAGESIZE 取得。\n    #"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@web001")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# getconf PAGESIZE\n    #"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("\n    #但也有client_header_buffer_size超过"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("k的情况，但是client_header_buffer_size该值必须设置为“系统分页大小”的整倍数。\n    client_header_buffer_size "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("k"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    #这个将为打开文件指定缓存，默认是没有启用的，max指定缓存数量，建议和打开文件数一致，inactive是指经过多长时间文件没被请求后删除缓存。\n    open_file_cache max"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("65535")]),s._v(" inactive"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),s._v("s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    #这个是指多长时间检查一次缓存的有效信息。\n    #语法"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("open_file_cache_valid time 默认值"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("open_file_cache_valid "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),s._v(" 使用字段"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("http"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" server"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" location 这个指令指定了何时需要检查open_file_cache中缓存项目的有效信息"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n    open_file_cache_valid "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    #open_file_cache指令中的inactive参数时间内文件的最少使用次数，如果超过这个数字，文件描述符一直是在缓存中打开的，如上例，如果有一个文件在inactive时间内一次没被使用，它将被移除。\n    #语法"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("open_file_cache_min_uses number 默认值"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("open_file_cache_min_uses "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" 使用字段"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("http"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" server"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" location  这个指令指定了在open_file_cache指令无效的参数中一定的时间范围内可以使用的最小文件数"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("如果使用更大的值"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("文件描述符在cache中总是打开状态"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n    open_file_cache_min_uses "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    \n    #语法"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("open_file_cache_errors on "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" off 默认值"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("open_file_cache_errors off 使用字段"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("http"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" server"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" location 这个指令指定是否在搜索一个文件是记录cache错误"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n    open_file_cache_errors on"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n \n \n \n#设定http服务器，利用它的反向代理功能提供负载均衡支持\nhttp\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t#实现对配置文件所包含的文件的设定，可以减少主配置文件的复杂度。类似于"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Apache")]),s._v("中的include方法。\n    #文件扩展名与文件类型映射表\n    include mime"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("types"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    #默认文件类型\n    default_type application"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("octet"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("stream"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    #默认编码\n    #charset utf"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    #服务器名字的hash表大小\n    #保存服务器名字的hash表是由指令server_names_hash_max_size 和server_names_hash_bucket_size所控制的。参数hash bucket size总是等于hash表的大小，并且是一路处理器缓存大小的倍数。在减少了在内存中的存取次数后，使在处理器中加速查找hash表键值成为可能。如果hash bucket size等于一路处理器缓存的大小，那么在查找键的时候，最坏的情况下在内存中查找的次数为"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("。第一次是确定存储单元的地址，第二次是在存储单元中查找键 值。因此，如果"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Nginx")]),s._v("给出需要增大hash max size 或 hash bucket size的提示，那么首要的是增大前一个参数的大小"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n    server_names_hash_bucket_size "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("128")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    #客户端请求头部的缓冲区大小。这个可以根据你的系统分页大小来设置，一般一个请求的头部大小不会超过"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("k，不过由于一般系统分页都要大于"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("k，所以这里设置为分页大小。分页大小可以用命令getconf PAGESIZE取得。\n    client_header_buffer_size "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),s._v("k"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    #客户请求头缓冲大小。nginx默认会用client_header_buffer_size这个buffer来读取header值，如果header过大，它会使用large_client_header_buffers来读取。\n    large_client_header_buffers "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v("k"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    #设定通过nginx上传文件的大小\n    client_max_body_size "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("m"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    #开启高效文件传输模式，sendfile指令指定nginx是否调用sendfile函数来输出文件，对于普通应用设为 on，如果用来进行下载等应用磁盘IO重负载应用，可设置为off，以平衡磁盘与网络"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("I")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("O")]),s._v("处理速度，降低系统的负载。注意：如果图片显示不正常把这个改成off。\n    #sendfile指令指定 nginx 是否调用sendfile 函数（zero copy 方式）来输出文件，对于普通应用，必须设为on。如果用来进行下载等应用磁盘IO重负载应用，可设置为off，以平衡磁盘与网络IO处理速度，降低系统uptime。\n    sendfile on"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    #开启目录列表访问，合适下载服务器，默认关闭。\n    autoindex on"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    #此选项允许或禁止使用socke的TCP_CORK的选项，此选项仅在使用sendfile的时候使用\n    tcp_nopush on"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n     \n    tcp_nodelay on"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    #长连接超时时间，单位是秒\n    keepalive_timeout "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("120")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    #"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("FastCGI")]),s._v("相关参数是为了改善网站的性能：减少资源占用，提高访问速度。下面参数看字面意思都能理解。\n    fastcgi_connect_timeout "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("300")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    fastcgi_send_timeout "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("300")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    fastcgi_read_timeout "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("300")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    fastcgi_buffer_size "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v("k"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    fastcgi_buffers "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v("k"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    fastcgi_busy_buffers_size "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("128")]),s._v("k"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    fastcgi_temp_file_write_size "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("128")]),s._v("k"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    #gzip模块设置\n    gzip on"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" #开启gzip压缩输出\n    gzip_min_length "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("k"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("    #最小压缩文件大小\n    gzip_buffers "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("k"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("    #压缩缓冲区\n    gzip_http_version "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("    #压缩版本（默认"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.1")]),s._v("，前端如果是squid2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("请使用"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.0")]),s._v("）\n    gzip_comp_level "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("    #压缩等级\n    gzip_types text"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("plain application"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("javascript text"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("css application"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("xml"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("    #压缩类型，默认就已经包含textml，所以下面就不用再写了，写上去也不会有问题，但是会有一个warn。\n    gzip_vary on"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    #开启限制IP连接数的时候需要使用\n    #limit_zone crawler $binary_remote_addr "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("m"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n\n    #负载均衡配置\n    upstream piao"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("jd"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n     \n        #upstream的负载均衡，weight是权重，可以根据机器配置定义权重。weigth参数表示权值，权值越高被分配到的几率越大。\n        server "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".80")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".121")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" weight"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        server "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".80")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".122")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" weight"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        server "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".80")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".123")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" weight"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        #nginx的upstream目前支持"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("种方式的分配\n        #"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("、轮询（默认）\n        #每个请求按时间顺序逐一分配到不同的后端服务器，如果后端服务器down掉，能自动剔除。\n        #"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("、weight\n        #指定轮询几率，weight和访问比率成正比，用于后端服务器性能不均的情况。\n        #例如：\n        #upstream bakend "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        #    server "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".14")]),s._v(" weight"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        #    server "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".15")]),s._v(" weight"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        #"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        #"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("、ip_hash\n        #每个请求按访问ip的hash结果分配，这样每个访客固定访问一个后端服务器，可以解决session的问题。\n        #例如：\n        #upstream bakend "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        #    ip_hash"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        #    server "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".14")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("88")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        #    server "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".15")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        #"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        #"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("、fair（第三方）\n        #按后端服务器的响应时间来分配请求，响应时间短的优先分配。\n        #upstream backend "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        #    server server1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        #    server server2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        #    fair"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        #"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        #"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("、url_hash（第三方）\n        #按访问url的hash结果来分配请求，使每个url定向到同一个后端服务器，后端服务器为缓存时比较有效。\n        #例：在upstream中加入hash语句，server语句中不能写入weight等其他的参数，hash_method是使用的hash算法\n        #upstream backend "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        #    server squid1"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3128")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        #    server squid2"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3128")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        #    hash $request_uri"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        #    hash_method crc32"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        #"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n        #tips"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n        #upstream bakend"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("#定义负载均衡设备的"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Ip")]),s._v("及设备状态"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        #    ip_hash"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        #    server "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9090")]),s._v(" down"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        #    server "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v(" weight"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        #    server "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6060")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        #    server "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7070")]),s._v(" backup"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        #"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        #在需要使用负载均衡的server中增加 proxy_pass http"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bakend"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        #每个设备的状态设置为"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n        #"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.d")]),s._v("own表示单前的server暂时不参与负载\n        #"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.")]),s._v("weight为weight越大，负载的权重就越大。\n        #"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.")]),s._v("max_fails：允许请求失败的次数默认为"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.")]),s._v("当超过最大次数时，返回proxy_next_upstream模块定义的错误\n        #"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.f")]),s._v("ail_timeout"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("max_fails次失败后，暂停的时间。\n        #"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.")]),s._v("backup： 其它所有的非backup机器down或者忙的时候，请求backup机器。所以这台机器压力会最轻。\n\n        #nginx支持同时设置多组的负载均衡，用来给不用的server来使用。\n        #client_body_in_file_only设置为"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("On")]),s._v(" 可以讲client post过来的数据记录到文件中用来做debug\n        #client_body_temp_path设置记录文件的目录 可以设置最多"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("层目录\n        #location对URL进行匹配"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("可以进行重定向或者进行新的代理 负载均衡\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n     \n     \n     \n    #虚拟主机的配置\n    server\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        #监听端口\n        listen "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        #域名可以有多个，用空格隔开\n        server_name www"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("jd"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com jd"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        index index"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("html index"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("htm index"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("php"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        root "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("data"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("www"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("jd"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        #对"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("进行负载均衡\n        location "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("*"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("php"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("php5"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("$\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            fastcgi_pass "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            fastcgi_index index"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("php"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            include fastcgi"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n         \n        #图片缓存时间设置\n        location "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("*"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("gif"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("jpg"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("jpeg"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("png"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("bmp"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("swf"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("$\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            expires "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10d")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n         \n        #JS和CSS缓存时间设置\n        location "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("*"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("js"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("css"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("$\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            expires "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("h"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n         \n        #日志格式设定\n        #$remote_addr与$http_x_forwarded_for用以记录客户端的ip地址；\n        #$remote_user：用来记录客户端用户名称；\n        #$time_local： 用来记录访问时间与时区；\n        #$request： 用来记录请求的url与http协议；\n        #$status： 用来记录请求状态；成功是"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),s._v("，\n        #$body_bytes_sent ：记录发送给客户端文件主体内容大小；\n        #$http_referer：用来记录从那个页面链接访问过来的；\n        #$http_user_agent：记录客户浏览器的相关信息；\n        #通常web服务器放在反向代理的后面，这样就不能获取到客户的IP地址了，通过$remote_add拿到的IP地址是反向代理服务器的iP地址。反向代理服务器在转发请求的http头信息中，可以增加x_forwarded_for信息，用以记录原有客户端的IP地址和原来客户端的请求的服务器地址。\n        log_format access '$remote_addr "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" $remote_user "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("$time_local"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$request"')]),s._v(" '\n        '$status $body_bytes_sent "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$http_referer"')]),s._v(" '\n        '"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$http_user_agent"')]),s._v(" $http_x_forwarded_for'"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n         \n        #定义本虚拟主机的访问日志\n        access_log  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("logs"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("host"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("access"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("log  main"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        access_log  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("logs"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("host"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("access"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("404.l")]),s._v("og  log404"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n         \n        #对 "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/"')]),s._v(" 启用反向代理\n        location "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            proxy_pass http"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("88")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            proxy_redirect off"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            proxy_set_header "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("X")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Real")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("IP $remote_addr"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n             \n            #后端的"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Web")]),s._v("服务器可以通过"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("X")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Forwarded")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("For")]),s._v("获取用户真实IP\n            proxy_set_header "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("X")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Forwarded")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("For")]),s._v(" $proxy_add_x_forwarded_for"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n             \n            #以下是一些反向代理的配置，可选。\n            proxy_set_header "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Host")]),s._v(" $host"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n            #允许客户端请求的最大单文件字节数\n            client_max_body_size "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("m"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n            #缓冲区代理缓冲用户端请求的最大字节数，\n            #如果把它设置为比较大的数值，例如"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("256")]),s._v("k，那么，无论使用firefox还是IE浏览器，来提交任意小于"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("256")]),s._v("k的图片，都很正常。如果注释该指令，使用默认的client_body_buffer_size设置，也就是操作系统页面大小的两倍，"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("k或者"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("k，问题就出现了。\n            #无论使用firefox4"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("还是IE8"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("，提交一个比较大，"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),s._v("k左右的图片，都返回"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("500")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Internal")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Server")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Error")]),s._v("错误\n            client_body_buffer_size "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("128")]),s._v("k"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n            #表示使nginx阻止HTTP应答代码为"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("400")]),s._v("或者更高的应答。\n            proxy_intercept_errors on"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n            #后端服务器连接的超时时间_发起握手等候响应超时时间\n            #nginx跟后端服务器连接超时时间"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("代理连接超时"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            proxy_connect_timeout "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("90")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n            #后端服务器数据回传时间"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("代理发送超时"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            #后端服务器数据回传时间_就是在规定时间之内后端服务器必须传完所有的数据\n            proxy_send_timeout "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("90")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n            #连接成功后，后端服务器响应时间"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("代理接收超时"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            #连接成功后_等候后端服务器响应时间_其实已经进入后端的排队之中等候处理（也可以说是后端服务器处理请求的时间）\n            proxy_read_timeout "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("90")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n            #设置代理服务器（nginx）保存用户头信息的缓冲区大小\n            #设置从被代理服务器读取的第一部分应答的缓冲区大小，通常情况下这部分应答中包含一个小的应答头，默认情况下这个值的大小为指令proxy_buffers中指定的一个缓冲区的大小，不过可以将其设置为更小\n            proxy_buffer_size "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("k"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n            #proxy_buffers缓冲区，网页平均在"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),s._v("k以下的设置\n            #设置用于读取应答（来自被代理服务器）的缓冲区数目和大小，默认情况也为分页大小，根据操作系统的不同可能是"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("k或者"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("k\n            proxy_buffers "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),s._v("k"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n            #高负荷下缓冲大小（proxy_buffers"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("）\n            proxy_busy_buffers_size "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v("k"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n            #设置在写入proxy_temp_path时数据的大小，预防一个工作进程在传递文件时阻塞太长\n            #设定缓存文件夹大小，大于这个值，将从upstream服务器传\n            proxy_temp_file_write_size "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v("k"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n         \n         \n        #设定查看"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Nginx")]),s._v("状态的地址\n        location "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("NginxStatus")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            stub_status on"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            access_log on"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            auth_basic "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"NginxStatus"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            auth_basic_user_file confpasswd"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            #htpasswd文件的内容可以用apache提供的htpasswd工具来产生。\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n         \n        #本地动静分离反向代理配置\n        #所有jsp的页面均交由tomcat或resin处理\n        location "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("jsp"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("jspx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("$ "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            proxy_set_header "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Host")]),s._v(" $host"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            proxy_set_header "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("X")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Real")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("IP $remote_addr"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            proxy_set_header "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("X")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Forwarded")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("For")]),s._v(" $proxy_add_x_forwarded_for"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            proxy_pass http"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n         \n        #所有静态文件由nginx直接读取不经过tomcat或resin\n        location "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("*"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("htm"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("html"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("gif"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("jpg"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("jpeg"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("png"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("bmp"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("swf"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("ioc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("rar"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("zip"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("txt"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("flv"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("mid"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("doc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("ppt"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n        pdf"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("xls"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("mp3"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("wma"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("$\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            expires "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15d")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n         \n        location "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("*"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("js"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("css"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("$\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            expires "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("h"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br"),t("span",{staticClass:"line-number"},[s._v("62")]),t("br"),t("span",{staticClass:"line-number"},[s._v("63")]),t("br"),t("span",{staticClass:"line-number"},[s._v("64")]),t("br"),t("span",{staticClass:"line-number"},[s._v("65")]),t("br"),t("span",{staticClass:"line-number"},[s._v("66")]),t("br"),t("span",{staticClass:"line-number"},[s._v("67")]),t("br"),t("span",{staticClass:"line-number"},[s._v("68")]),t("br"),t("span",{staticClass:"line-number"},[s._v("69")]),t("br"),t("span",{staticClass:"line-number"},[s._v("70")]),t("br"),t("span",{staticClass:"line-number"},[s._v("71")]),t("br"),t("span",{staticClass:"line-number"},[s._v("72")]),t("br"),t("span",{staticClass:"line-number"},[s._v("73")]),t("br"),t("span",{staticClass:"line-number"},[s._v("74")]),t("br"),t("span",{staticClass:"line-number"},[s._v("75")]),t("br"),t("span",{staticClass:"line-number"},[s._v("76")]),t("br"),t("span",{staticClass:"line-number"},[s._v("77")]),t("br"),t("span",{staticClass:"line-number"},[s._v("78")]),t("br"),t("span",{staticClass:"line-number"},[s._v("79")]),t("br"),t("span",{staticClass:"line-number"},[s._v("80")]),t("br"),t("span",{staticClass:"line-number"},[s._v("81")]),t("br"),t("span",{staticClass:"line-number"},[s._v("82")]),t("br"),t("span",{staticClass:"line-number"},[s._v("83")]),t("br"),t("span",{staticClass:"line-number"},[s._v("84")]),t("br"),t("span",{staticClass:"line-number"},[s._v("85")]),t("br"),t("span",{staticClass:"line-number"},[s._v("86")]),t("br"),t("span",{staticClass:"line-number"},[s._v("87")]),t("br"),t("span",{staticClass:"line-number"},[s._v("88")]),t("br"),t("span",{staticClass:"line-number"},[s._v("89")]),t("br"),t("span",{staticClass:"line-number"},[s._v("90")]),t("br"),t("span",{staticClass:"line-number"},[s._v("91")]),t("br"),t("span",{staticClass:"line-number"},[s._v("92")]),t("br"),t("span",{staticClass:"line-number"},[s._v("93")]),t("br"),t("span",{staticClass:"line-number"},[s._v("94")]),t("br"),t("span",{staticClass:"line-number"},[s._v("95")]),t("br"),t("span",{staticClass:"line-number"},[s._v("96")]),t("br"),t("span",{staticClass:"line-number"},[s._v("97")]),t("br"),t("span",{staticClass:"line-number"},[s._v("98")]),t("br"),t("span",{staticClass:"line-number"},[s._v("99")]),t("br"),t("span",{staticClass:"line-number"},[s._v("100")]),t("br"),t("span",{staticClass:"line-number"},[s._v("101")]),t("br"),t("span",{staticClass:"line-number"},[s._v("102")]),t("br"),t("span",{staticClass:"line-number"},[s._v("103")]),t("br"),t("span",{staticClass:"line-number"},[s._v("104")]),t("br"),t("span",{staticClass:"line-number"},[s._v("105")]),t("br"),t("span",{staticClass:"line-number"},[s._v("106")]),t("br"),t("span",{staticClass:"line-number"},[s._v("107")]),t("br"),t("span",{staticClass:"line-number"},[s._v("108")]),t("br"),t("span",{staticClass:"line-number"},[s._v("109")]),t("br"),t("span",{staticClass:"line-number"},[s._v("110")]),t("br"),t("span",{staticClass:"line-number"},[s._v("111")]),t("br"),t("span",{staticClass:"line-number"},[s._v("112")]),t("br"),t("span",{staticClass:"line-number"},[s._v("113")]),t("br"),t("span",{staticClass:"line-number"},[s._v("114")]),t("br"),t("span",{staticClass:"line-number"},[s._v("115")]),t("br"),t("span",{staticClass:"line-number"},[s._v("116")]),t("br"),t("span",{staticClass:"line-number"},[s._v("117")]),t("br"),t("span",{staticClass:"line-number"},[s._v("118")]),t("br"),t("span",{staticClass:"line-number"},[s._v("119")]),t("br"),t("span",{staticClass:"line-number"},[s._v("120")]),t("br"),t("span",{staticClass:"line-number"},[s._v("121")]),t("br"),t("span",{staticClass:"line-number"},[s._v("122")]),t("br"),t("span",{staticClass:"line-number"},[s._v("123")]),t("br"),t("span",{staticClass:"line-number"},[s._v("124")]),t("br"),t("span",{staticClass:"line-number"},[s._v("125")]),t("br"),t("span",{staticClass:"line-number"},[s._v("126")]),t("br"),t("span",{staticClass:"line-number"},[s._v("127")]),t("br"),t("span",{staticClass:"line-number"},[s._v("128")]),t("br"),t("span",{staticClass:"line-number"},[s._v("129")]),t("br"),t("span",{staticClass:"line-number"},[s._v("130")]),t("br"),t("span",{staticClass:"line-number"},[s._v("131")]),t("br"),t("span",{staticClass:"line-number"},[s._v("132")]),t("br"),t("span",{staticClass:"line-number"},[s._v("133")]),t("br"),t("span",{staticClass:"line-number"},[s._v("134")]),t("br"),t("span",{staticClass:"line-number"},[s._v("135")]),t("br"),t("span",{staticClass:"line-number"},[s._v("136")]),t("br"),t("span",{staticClass:"line-number"},[s._v("137")]),t("br"),t("span",{staticClass:"line-number"},[s._v("138")]),t("br"),t("span",{staticClass:"line-number"},[s._v("139")]),t("br"),t("span",{staticClass:"line-number"},[s._v("140")]),t("br"),t("span",{staticClass:"line-number"},[s._v("141")]),t("br"),t("span",{staticClass:"line-number"},[s._v("142")]),t("br"),t("span",{staticClass:"line-number"},[s._v("143")]),t("br"),t("span",{staticClass:"line-number"},[s._v("144")]),t("br"),t("span",{staticClass:"line-number"},[s._v("145")]),t("br"),t("span",{staticClass:"line-number"},[s._v("146")]),t("br"),t("span",{staticClass:"line-number"},[s._v("147")]),t("br"),t("span",{staticClass:"line-number"},[s._v("148")]),t("br"),t("span",{staticClass:"line-number"},[s._v("149")]),t("br"),t("span",{staticClass:"line-number"},[s._v("150")]),t("br"),t("span",{staticClass:"line-number"},[s._v("151")]),t("br"),t("span",{staticClass:"line-number"},[s._v("152")]),t("br"),t("span",{staticClass:"line-number"},[s._v("153")]),t("br"),t("span",{staticClass:"line-number"},[s._v("154")]),t("br"),t("span",{staticClass:"line-number"},[s._v("155")]),t("br"),t("span",{staticClass:"line-number"},[s._v("156")]),t("br"),t("span",{staticClass:"line-number"},[s._v("157")]),t("br"),t("span",{staticClass:"line-number"},[s._v("158")]),t("br"),t("span",{staticClass:"line-number"},[s._v("159")]),t("br"),t("span",{staticClass:"line-number"},[s._v("160")]),t("br"),t("span",{staticClass:"line-number"},[s._v("161")]),t("br"),t("span",{staticClass:"line-number"},[s._v("162")]),t("br"),t("span",{staticClass:"line-number"},[s._v("163")]),t("br"),t("span",{staticClass:"line-number"},[s._v("164")]),t("br"),t("span",{staticClass:"line-number"},[s._v("165")]),t("br"),t("span",{staticClass:"line-number"},[s._v("166")]),t("br"),t("span",{staticClass:"line-number"},[s._v("167")]),t("br"),t("span",{staticClass:"line-number"},[s._v("168")]),t("br"),t("span",{staticClass:"line-number"},[s._v("169")]),t("br"),t("span",{staticClass:"line-number"},[s._v("170")]),t("br"),t("span",{staticClass:"line-number"},[s._v("171")]),t("br"),t("span",{staticClass:"line-number"},[s._v("172")]),t("br"),t("span",{staticClass:"line-number"},[s._v("173")]),t("br"),t("span",{staticClass:"line-number"},[s._v("174")]),t("br"),t("span",{staticClass:"line-number"},[s._v("175")]),t("br"),t("span",{staticClass:"line-number"},[s._v("176")]),t("br"),t("span",{staticClass:"line-number"},[s._v("177")]),t("br"),t("span",{staticClass:"line-number"},[s._v("178")]),t("br"),t("span",{staticClass:"line-number"},[s._v("179")]),t("br"),t("span",{staticClass:"line-number"},[s._v("180")]),t("br"),t("span",{staticClass:"line-number"},[s._v("181")]),t("br"),t("span",{staticClass:"line-number"},[s._v("182")]),t("br"),t("span",{staticClass:"line-number"},[s._v("183")]),t("br"),t("span",{staticClass:"line-number"},[s._v("184")]),t("br"),t("span",{staticClass:"line-number"},[s._v("185")]),t("br"),t("span",{staticClass:"line-number"},[s._v("186")]),t("br"),t("span",{staticClass:"line-number"},[s._v("187")]),t("br"),t("span",{staticClass:"line-number"},[s._v("188")]),t("br"),t("span",{staticClass:"line-number"},[s._v("189")]),t("br"),t("span",{staticClass:"line-number"},[s._v("190")]),t("br"),t("span",{staticClass:"line-number"},[s._v("191")]),t("br"),t("span",{staticClass:"line-number"},[s._v("192")]),t("br"),t("span",{staticClass:"line-number"},[s._v("193")]),t("br"),t("span",{staticClass:"line-number"},[s._v("194")]),t("br"),t("span",{staticClass:"line-number"},[s._v("195")]),t("br"),t("span",{staticClass:"line-number"},[s._v("196")]),t("br"),t("span",{staticClass:"line-number"},[s._v("197")]),t("br"),t("span",{staticClass:"line-number"},[s._v("198")]),t("br"),t("span",{staticClass:"line-number"},[s._v("199")]),t("br"),t("span",{staticClass:"line-number"},[s._v("200")]),t("br"),t("span",{staticClass:"line-number"},[s._v("201")]),t("br"),t("span",{staticClass:"line-number"},[s._v("202")]),t("br"),t("span",{staticClass:"line-number"},[s._v("203")]),t("br"),t("span",{staticClass:"line-number"},[s._v("204")]),t("br"),t("span",{staticClass:"line-number"},[s._v("205")]),t("br"),t("span",{staticClass:"line-number"},[s._v("206")]),t("br"),t("span",{staticClass:"line-number"},[s._v("207")]),t("br"),t("span",{staticClass:"line-number"},[s._v("208")]),t("br"),t("span",{staticClass:"line-number"},[s._v("209")]),t("br"),t("span",{staticClass:"line-number"},[s._v("210")]),t("br"),t("span",{staticClass:"line-number"},[s._v("211")]),t("br"),t("span",{staticClass:"line-number"},[s._v("212")]),t("br"),t("span",{staticClass:"line-number"},[s._v("213")]),t("br"),t("span",{staticClass:"line-number"},[s._v("214")]),t("br"),t("span",{staticClass:"line-number"},[s._v("215")]),t("br"),t("span",{staticClass:"line-number"},[s._v("216")]),t("br"),t("span",{staticClass:"line-number"},[s._v("217")]),t("br"),t("span",{staticClass:"line-number"},[s._v("218")]),t("br"),t("span",{staticClass:"line-number"},[s._v("219")]),t("br"),t("span",{staticClass:"line-number"},[s._v("220")]),t("br"),t("span",{staticClass:"line-number"},[s._v("221")]),t("br"),t("span",{staticClass:"line-number"},[s._v("222")]),t("br"),t("span",{staticClass:"line-number"},[s._v("223")]),t("br"),t("span",{staticClass:"line-number"},[s._v("224")]),t("br"),t("span",{staticClass:"line-number"},[s._v("225")]),t("br"),t("span",{staticClass:"line-number"},[s._v("226")]),t("br"),t("span",{staticClass:"line-number"},[s._v("227")]),t("br"),t("span",{staticClass:"line-number"},[s._v("228")]),t("br"),t("span",{staticClass:"line-number"},[s._v("229")]),t("br"),t("span",{staticClass:"line-number"},[s._v("230")]),t("br"),t("span",{staticClass:"line-number"},[s._v("231")]),t("br"),t("span",{staticClass:"line-number"},[s._v("232")]),t("br"),t("span",{staticClass:"line-number"},[s._v("233")]),t("br"),t("span",{staticClass:"line-number"},[s._v("234")]),t("br"),t("span",{staticClass:"line-number"},[s._v("235")]),t("br"),t("span",{staticClass:"line-number"},[s._v("236")]),t("br"),t("span",{staticClass:"line-number"},[s._v("237")]),t("br"),t("span",{staticClass:"line-number"},[s._v("238")]),t("br"),t("span",{staticClass:"line-number"},[s._v("239")]),t("br"),t("span",{staticClass:"line-number"},[s._v("240")]),t("br"),t("span",{staticClass:"line-number"},[s._v("241")]),t("br"),t("span",{staticClass:"line-number"},[s._v("242")]),t("br"),t("span",{staticClass:"line-number"},[s._v("243")]),t("br"),t("span",{staticClass:"line-number"},[s._v("244")]),t("br"),t("span",{staticClass:"line-number"},[s._v("245")]),t("br"),t("span",{staticClass:"line-number"},[s._v("246")]),t("br"),t("span",{staticClass:"line-number"},[s._v("247")]),t("br"),t("span",{staticClass:"line-number"},[s._v("248")]),t("br"),t("span",{staticClass:"line-number"},[s._v("249")]),t("br"),t("span",{staticClass:"line-number"},[s._v("250")]),t("br"),t("span",{staticClass:"line-number"},[s._v("251")]),t("br"),t("span",{staticClass:"line-number"},[s._v("252")]),t("br"),t("span",{staticClass:"line-number"},[s._v("253")]),t("br"),t("span",{staticClass:"line-number"},[s._v("254")]),t("br"),t("span",{staticClass:"line-number"},[s._v("255")]),t("br"),t("span",{staticClass:"line-number"},[s._v("256")]),t("br"),t("span",{staticClass:"line-number"},[s._v("257")]),t("br"),t("span",{staticClass:"line-number"},[s._v("258")]),t("br"),t("span",{staticClass:"line-number"},[s._v("259")]),t("br"),t("span",{staticClass:"line-number"},[s._v("260")]),t("br"),t("span",{staticClass:"line-number"},[s._v("261")]),t("br"),t("span",{staticClass:"line-number"},[s._v("262")]),t("br"),t("span",{staticClass:"line-number"},[s._v("263")]),t("br"),t("span",{staticClass:"line-number"},[s._v("264")]),t("br"),t("span",{staticClass:"line-number"},[s._v("265")]),t("br"),t("span",{staticClass:"line-number"},[s._v("266")]),t("br"),t("span",{staticClass:"line-number"},[s._v("267")]),t("br"),t("span",{staticClass:"line-number"},[s._v("268")]),t("br"),t("span",{staticClass:"line-number"},[s._v("269")]),t("br"),t("span",{staticClass:"line-number"},[s._v("270")]),t("br"),t("span",{staticClass:"line-number"},[s._v("271")]),t("br"),t("span",{staticClass:"line-number"},[s._v("272")]),t("br"),t("span",{staticClass:"line-number"},[s._v("273")]),t("br"),t("span",{staticClass:"line-number"},[s._v("274")]),t("br"),t("span",{staticClass:"line-number"},[s._v("275")]),t("br"),t("span",{staticClass:"line-number"},[s._v("276")]),t("br"),t("span",{staticClass:"line-number"},[s._v("277")]),t("br"),t("span",{staticClass:"line-number"},[s._v("278")]),t("br"),t("span",{staticClass:"line-number"},[s._v("279")]),t("br"),t("span",{staticClass:"line-number"},[s._v("280")]),t("br"),t("span",{staticClass:"line-number"},[s._v("281")]),t("br"),t("span",{staticClass:"line-number"},[s._v("282")]),t("br"),t("span",{staticClass:"line-number"},[s._v("283")]),t("br"),t("span",{staticClass:"line-number"},[s._v("284")]),t("br"),t("span",{staticClass:"line-number"},[s._v("285")]),t("br"),t("span",{staticClass:"line-number"},[s._v("286")]),t("br"),t("span",{staticClass:"line-number"},[s._v("287")]),t("br"),t("span",{staticClass:"line-number"},[s._v("288")]),t("br"),t("span",{staticClass:"line-number"},[s._v("289")]),t("br"),t("span",{staticClass:"line-number"},[s._v("290")]),t("br"),t("span",{staticClass:"line-number"},[s._v("291")]),t("br"),t("span",{staticClass:"line-number"},[s._v("292")]),t("br"),t("span",{staticClass:"line-number"},[s._v("293")]),t("br"),t("span",{staticClass:"line-number"},[s._v("294")]),t("br"),t("span",{staticClass:"line-number"},[s._v("295")]),t("br"),t("span",{staticClass:"line-number"},[s._v("296")]),t("br"),t("span",{staticClass:"line-number"},[s._v("297")]),t("br"),t("span",{staticClass:"line-number"},[s._v("298")]),t("br"),t("span",{staticClass:"line-number"},[s._v("299")]),t("br"),t("span",{staticClass:"line-number"},[s._v("300")]),t("br"),t("span",{staticClass:"line-number"},[s._v("301")]),t("br"),t("span",{staticClass:"line-number"},[s._v("302")]),t("br"),t("span",{staticClass:"line-number"},[s._v("303")]),t("br"),t("span",{staticClass:"line-number"},[s._v("304")]),t("br"),t("span",{staticClass:"line-number"},[s._v("305")]),t("br"),t("span",{staticClass:"line-number"},[s._v("306")]),t("br"),t("span",{staticClass:"line-number"},[s._v("307")]),t("br"),t("span",{staticClass:"line-number"},[s._v("308")]),t("br"),t("span",{staticClass:"line-number"},[s._v("309")]),t("br"),t("span",{staticClass:"line-number"},[s._v("310")]),t("br"),t("span",{staticClass:"line-number"},[s._v("311")]),t("br"),t("span",{staticClass:"line-number"},[s._v("312")]),t("br"),t("span",{staticClass:"line-number"},[s._v("313")]),t("br"),t("span",{staticClass:"line-number"},[s._v("314")]),t("br"),t("span",{staticClass:"line-number"},[s._v("315")]),t("br"),t("span",{staticClass:"line-number"},[s._v("316")]),t("br"),t("span",{staticClass:"line-number"},[s._v("317")]),t("br"),t("span",{staticClass:"line-number"},[s._v("318")]),t("br"),t("span",{staticClass:"line-number"},[s._v("319")]),t("br"),t("span",{staticClass:"line-number"},[s._v("320")]),t("br"),t("span",{staticClass:"line-number"},[s._v("321")]),t("br"),t("span",{staticClass:"line-number"},[s._v("322")]),t("br"),t("span",{staticClass:"line-number"},[s._v("323")]),t("br"),t("span",{staticClass:"line-number"},[s._v("324")]),t("br"),t("span",{staticClass:"line-number"},[s._v("325")]),t("br"),t("span",{staticClass:"line-number"},[s._v("326")]),t("br")])]),t("h2",{attrs:{id:"_5-配置反向代理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-配置反向代理"}},[s._v("#")]),s._v(" 5. 配置反向代理")]),s._v(" "),t("h3",{attrs:{id:"案例一"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#案例一"}},[s._v("#")]),s._v(" 案例一：")]),s._v(" "),t("p",[s._v("案例效果：打开浏览器，在浏览器地址栏输入地址 www.123.com ，跳转到 liunx 系统 tomcat 主页面中")]),s._v(" "),t("p",[s._v("前面我们已经了解了反向代理是代理后端服务器的，我们以一张图再回顾一下，这张图也是此案例配置的示例图！\n"),t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-338cc03a3fb342dc99cbf3979e84d154.png",alt:"image.png"}}),s._v("\n从图中我们可以看出，我们还需要配置tomcat，安装tomcat可参考：https://www.yuque.com/bithachi/study/ko2vq0 的第5个内容。")]),s._v(" "),t("p",[s._v("并且Nginx开放80端口，可参考上面的安装Nginx部分配置端口。")]),s._v(" "),t("p",[s._v("我们将图上所述的配置好之后，启动nginx测试，windows浏览器访问www.123.com，Nginx反向代理服务器会将请求转发到tomcat默认测试的127.0.0.1：8080页面。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-bd1b43adc5ee4690be69a48662a83bfb.png",alt:"image.png"}})]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-558239dd026544d9a456a9d4ec279282.png",alt:"image.png"}})]),s._v(" "),t("h4",{attrs:{id:"在linux中安装-tomcat"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#在linux中安装-tomcat"}},[s._v("#")]),s._v(" 在Linux中安装 tomcat")]),s._v(" "),t("p",[s._v("效果图：\n"),t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-ff7126f2bbe7485291886b76a4f114a1.png",alt:"image.png"}})]),s._v(" "),t("h5",{attrs:{id:"一、首先到官方下载tomcat服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一、首先到官方下载tomcat服务"}},[s._v("#")]),s._v(" 一、首先到官方下载tomcat服务")]),s._v(" "),t("h5",{attrs:{id:"二、将tomcat上传至linux服务器中"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二、将tomcat上传至linux服务器中"}},[s._v("#")]),s._v(" 二、将tomcat上传至linux服务器中")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-6778164c84e849cbac540390389a149c.png",alt:"image.png"}})]),s._v(" "),t("p",[s._v("2.解压：tar zxvf apache-tomcat-7.0.67.tar.gz")]),s._v(" "),t("h5",{attrs:{id:"三、配置环境编辑-etc-profile文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三、配置环境编辑-etc-profile文件"}},[s._v("#")]),s._v(" 三、配置环境编辑/etc/profile文件")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("JAVA_HOME"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("rommr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("jdk1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6.0_45")]),s._v("\nPATH"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("$JAVA_HOME"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("$"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PATH")]),s._v("\nCLASSPATH"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("$JAVA_HOME"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("lib"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("dt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("jar"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("$JAVA_HOME"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("lib"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("tools"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("jar\nCATALINA_HOME"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("rommr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("tomcat7 #其他的是jdk配置 重要的就是这点\nexport JAVA_HOME CATALINA_HOME #这点ok\nexport PATH\nexport "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("CLASSPATH")]),s._v("\nJAVA_HOME"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("rommr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("jdk1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6.0_45")]),s._v("\nPATH"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("$JAVA_HOME"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("$"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PATH")]),s._v("\nCLASSPATH"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("$JAVA_HOME"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("lib"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("dt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("jar"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("$JAVA_HOME"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("lib"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("tools"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("jar\nCATALINA_HOME"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("rommr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("tomcat7 #其他的是jdk配置 重要的就是这点\nexport JAVA_HOME CATALINA_HOME #这点ok\nexport PATH\nexport CLASSPATH\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("p",[s._v("以上配置完后执行： source /etc/profile 配置文件生效")]),s._v(" "),t("h5",{attrs:{id:"四、启动tomcat-进入tomcat-bin目录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#四、启动tomcat-进入tomcat-bin目录"}},[s._v("#")]),s._v(" 四、启动tomcat 进入tomcat bin目录")]),s._v(" "),t("p",[s._v("./startup.sh启动 ./shutdown.sh关闭命令\n"),t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-a9ab389faa1745efa316805779d9904f.png",alt:"image.png"}}),s._v("\n启动命令之后浏览器上输入：http:\\localhost:8080\\ 如果在外部访问需要写上ip地址http:\\192.168.38.128:8080\\ 可以看到tomcat信息")]),s._v(" "),t("h5",{attrs:{id:"五-开启防火墙8080端口"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#五-开启防火墙8080端口"}},[s._v("#")]),s._v(" 五 开启防火墙8080端口")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-98f76dd718a641d9bf71f6f1a749c40e.png",alt:"image.png"}}),s._v(" "),t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-7e1588b077aa459ea739fad7ab70b604.png",alt:"image.png"}})]),s._v(" "),t("h4",{attrs:{id:"配置nginx配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置nginx配置文件"}},[s._v("#")]),s._v(" 配置nginx配置文件")]),s._v(" "),t("p",[s._v("在/usr/local/nginx/conf/nginx.conf\n"),t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-0e73868074be43868e526f802b45c71a.png",alt:"image.png"}})]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-e87ac1b564294d90a7d8d063318e0806.png",alt:"image.png"}})]),s._v(" "),t("h3",{attrs:{id:"_5-2-案例二"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-案例二"}},[s._v("#")]),s._v(" 5.2 案例二")]),s._v(" "),t("p",[s._v("实现效果：使用 nginx 反向代理，根据访问的路径跳转到不同端口的服务中nginx 监听端口为 9001\n访问 http://192.168.14.128:9001/edu/ 直接跳转到 127.0.0.1:8080\n访问 http:// 192.168.14.128:9001/vod/ 直接跳转到 127.0.0.1:8081")]),s._v(" "),t("p",[s._v("配置步骤：\n（1 ）准备两个 tomcat 服务器，一个 8080 端口，一个 8081 端口\n（2 ）创建文件夹edu和vod和测试页面a.html\n（3 ）开放对外访问的端口号 9001 8080 8081\n(4 ）修改nginx.conf\n(5）测试访问\n"),t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Control-body/tuChuang/2022/04/image-f18045a2e54b44e0b6346ec5039e5002.png",alt:"image.png"}}),s._v("\nnginx.conf中http块中的location块 配置说明：\nlocation用于匹配 URL，语法如下：")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("location "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" uri "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ：用于不含正则表达式的 uri 前，要求请求字符串与 uri 严格匹配，如果匹配成功，就停止继续向下搜索并立即处理该请求。\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),s._v("：用于表示 uri 包含正则表达式，并且区分大小写。\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("：用于表示 uri 包含正则表达式，并且不区分大小写。\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),s._v("：用于不含正则表达式的 uri 前，要求 "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Nginx")]),s._v(" 服务器找到标识 uri 和请求字符串匹配度最高的 location 后，立即使用此 location 处理请求，而不再使用 location块中的正则 uri 和请求字符串做匹配。\n注意：如果uri包含正则表达式，则必须要有 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),s._v(" 或者 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" 标识。\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("h3",{attrs:{id:"_5-3-安装成系统服务-开机自启"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-安装成系统服务-开机自启"}},[s._v("#")]),s._v(" 5.3 安装成系统服务，开机自启")]),s._v(" "),t("ul",[t("li",[s._v("创建服务脚本\nvi /usr/lib/systemd/system/nginx.service")]),s._v(" "),t("li",[s._v("服务脚本内容")])]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Unit")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Description")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" web server\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("After")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("network"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("target remote"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("fs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("target nss"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("lookup"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("target\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Service")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Type")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("forking\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PIDFile")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("logs"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pid\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ExecStartPre")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sbin"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("t "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("c "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("conf"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ExecStart")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sbin"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("c "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("conf"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ExecReload")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sbin"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("s reload\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ExecStop")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sbin"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("s stop\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ExecQuit")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sbin"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("s quit\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PrivateTmp")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Install")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("WantedBy")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("multi"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("user"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("target\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("ul",[t("li",[t("p",[s._v("重新加载系统服务\nsystemctl daemon-reload")])]),s._v(" "),t("li",[t("p",[s._v("启动服务\nsystemctl start nginx.service"),t("br"),s._v("\n使用系统启动服务之前，建议先把之前启动的关闭，否则可能有冲突")])]),s._v(" "),t("li",[t("p",[s._v("重新启动nginx服务\nsystemctl reload nginx")])]),s._v(" "),t("li",[t("p",[s._v("开机启动"),t("br"),s._v("\nsystemctl enable nginx.service")])])]),s._v(" "),t("h3",{attrs:{id:"_5-4-启动与关闭-nginx"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-4-启动与关闭-nginx"}},[s._v("#")]),s._v(" 5.4 启动与关闭 nginx")]),s._v(" "),t("h4",{attrs:{id:"_1-停止nginx服务的四种方法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-停止nginx服务的四种方法"}},[s._v("#")]),s._v(" 1.停止Nginx服务的四种方法")]),s._v(" "),t("p",[s._v("从容停止服务")]),s._v(" "),t("p",[s._v("这种方法较stop相比就比较温和一些了，需要进程完成当前工作后再停止。")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("nginx "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("s quit\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("立即停止服务")]),s._v(" "),t("p",[s._v("这种方法比较强硬，无论进程是否在工作，都直接停止进程。")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("nginx "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("s stop\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("systemctl 停止")]),s._v(" "),t("p",[s._v("systemctl属于Linux命令")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("systemctl stop nginx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("service\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("killall 方法杀死进程")]),s._v(" "),t("p",[s._v("直接杀死进程，在上面无效的情况下使用，态度强硬，简单粗暴！")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("killall nginx\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h4",{attrs:{id:"_2-启动nginx"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-启动nginx"}},[s._v("#")]),s._v(" 2.启动Nginx")]),s._v(" "),t("p",[s._v("nginx直接启动")]),s._v(" "),t("p",[s._v("nginx")]),s._v(" "),t("p",[s._v("systemctl命令启动")]),s._v(" "),t("p",[s._v("systemctl start nginx.service")]),s._v(" "),t("h4",{attrs:{id:"_3-查看启动后记录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-查看启动后记录"}},[s._v("#")]),s._v(" 3.查看启动后记录")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("ps aux "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" grep nginx\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h4",{attrs:{id:"_4-重启nginx服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-重启nginx服务"}},[s._v("#")]),s._v(" 4.重启Nginx服务")]),s._v(" "),t("p",[s._v("systemctl restart nginx.service")]),s._v(" "),t("h4",{attrs:{id:"_5-重新载入配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-重新载入配置文件"}},[s._v("#")]),s._v(" 5.重新载入配置文件")]),s._v(" "),t("p",[s._v("当有系统配置文件有修改，用此命令，建议不要停止再重启，以防报错！")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("nginx "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("s reload\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h4",{attrs:{id:"_6-查看端口号"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-查看端口号"}},[s._v("#")]),s._v(" 6.查看端口号")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("netstat "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("tlnp\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"nginx-配置环境变量"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nginx-配置环境变量"}},[s._v("#")]),s._v(" nginx 配置环境变量")]),s._v(" "),t("p",[s._v("环境变量配置文件")]),s._v(" "),t("p",[s._v("如想将一个路径加入到$PATH中，可以像下面这样做：")]),s._v(" "),t("h4",{attrs:{id:"_1-控制台中"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-控制台中"}},[s._v("#")]),s._v(" 1. 控制台中：")]),s._v(" "),t("p",[s._v('$ PATH="$PATH:/my_new_path"    (关闭shell，会还原PATH)')]),s._v(" "),t("h4",{attrs:{id:"_2-修改profile文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-修改profile文件"}},[s._v("#")]),s._v(" 2. 修改profile文件：")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("$ vi "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("profile\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("以交叉编译环境为例：")]),s._v(" "),t("p",[s._v("交叉编译工具器在 /usr/local/nginx/sbin")]),s._v(" "),t("p",[s._v("找到下面内容")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$EUID"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" then\n\npathmunge "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sbin\n\npathmunge "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sbin\n\npathmunge "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sbin\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("p",[s._v("在这个后面加上: pathmunge /usr/local/nginx/sbin")]),s._v(" "),t("p",[s._v("之后执行命令：source /etc/profile   （nginx 就可以生效了）")]),s._v(" "),t("h4",{attrs:{id:"_3-修改-bashrc文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-修改-bashrc文件"}},[s._v("#")]),s._v(" 3. 修改.bashrc文件：")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("\n$ vi "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("root"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("bashrc\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("在里面加入：")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("\nexport PATH"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$PATH:/my_new_path"')]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("后两种方法一般需要重新注销系统才能生效，最后可以通过echo命令测试一下：")]),s._v(" "),t("p",[s._v("$ echo $PATH")]),s._v(" "),t("p",[s._v("输出已经是新路径了。")]),s._v(" "),t("p",[s._v("举个列子，如果想把当前路径加入到环境变量中去，就可以这样做：")]),s._v(" "),t("p",[s._v('$   PATH ="$PATH:."')]),s._v(" "),t("p",[s._v("这样运行自己编写的shell脚本时就可以不输入./了。")]),s._v(" "),t("p",[t("strong",[s._v("注意")]),s._v("： 服务是服务 exe是exe ，服务是后台运行的，而配置在环境变量中的bin是运行在前台的程序；")])])}),[],!1,null,null,null);a.default=r.exports}}]);